\input cwebmac
\def\Real{\bf R}
\def\Complex{\bf C}
\def\Rdouble{\bf R}
\def\Cdouble{\bf C}
\def\cube{\bf A}
\def\reps#1{\bf S(\hbox{#1})}
\def\abs#1{|{#1}|}
\def\ra{\rightarrow}
\def\shortGen#1{s(#1)}
\def\closeGen#1#2{c(#1,#2)}
\def\PSL{\bf PSL}
\def\PSLC{\PSL_2{\Complex}}
\def\olength#1{\bf L_o(#1)}
\def\Nolength#1#2{\bf L_#2(#1)}
\def\tlength#1{\bf L(#1)}
\def\group#1{\bf G(#1)}
\def\union{\cup}
\def\intersect{\cap}
\def\Union{\bigcup}
\def\Intersect{\bigcap}
\def\cross{x}
\def\lemma#1{LEMMA #1}
\def\endlemma{}
\def\proposition#1{PROPOSITION $#1$}
\def\endproposition{}

\N{1}{1}Overview.
The purpose of this program is to be used in the proof of:

Theorem.
Let $N$ be a closed orientable hyperbolic
3-manifold.  Then if $f:M\to N$ is a homotopy equivalence where $M$
is an irreducible manifold, then $f$ is  homotopic to a homeomorphism.

The details of the proof and how it uses the result of this program
are beyond the scope of this document.
It is not so clear what exactly the scope should be,
but I have chosen to make it as narrow as possible,
with occasional references to higher-level concepts.

I have made an effort to make this program comprehensible to mathematicians
without an extensive background in programming.
It is written in \CEE/++, but mostly it is a \CEE/ program -- the only
departures from \CEE/ are in defining expressions like \PB{$\|x+\|y$} when
\PB{\|x} and \PB{\|y} are composite types (e.g., complex numbers), and
for constructing composite types (e.g., \PB{$\&{XComplex}(\|a,\|b)$}) from
their component parts, and declaring variables as they are needed
(instead of at the beginning of the function).
My hope is that anyone who has written a short \CEE/ program will
be able to understand this program.

This draft includes the program, and statements of the lemmas
needed for a proof of its correctness.

If $g,h \in \PSLC$, we will define the
translation length $L(g) \in \Complex$ of $g$
and the ortholength $L_h(g) \in \Complex$ of $g$ with respect to $h$.

A pair $(f,w) \in \PSLC$ is minimal if,
for all $g \in <f,w>, g \ne I$,
(i) $\abs{L(f)} \le \abs{L(g)}$ and
(ii) $\abs{L_f(w)} \le \abs{L_f(g)}$.

We will define maps
$s : \Complex \ra \PSLC$ and
$c : \Complex^2 \ra \PSLC$,
and a domain $D \subset \Complex^3$
(chosen so that $(s,c) : \Complex^3 \ra \PSLC\cross\PSLC$ covers the space
of groups of interest, modulo conjugation).

We will also define a ``recursive partition''
$Z : \{0,1\}^* \ra 2^{\Complex^3}$ of $D$ such that
$Z(s) = Z(s 0) \union Z(s 1)$ for all $s \in \{0,1\}^*$
and $Z(\lambda) \supset D$.

If $R \subset \Complex^3$, and if $(s(x_0), c(x_1,x_2))$ is not minimal
for any $x \in R \intersect D$, we say that $R$ is MNG-free.

\lemma
If this program finishes, and prints
``verified $p$ - $\{ m_0\ m_1\ \ldots\ m_k \}$.'',
then $Z(p) - \Union_i Z(m_i)$ is MNG-free.
\endlemma

The input to the program is a sequence of integers,
which encode how the proof is to be carried out.
This input can affect how long the program will run,
and determines whether or not it will finish,
but does not affect the correctness of its proof.
All of these inputs were produced by programs,
some of which are a good deal more complicated than this one,
but fortunately they are also beyond the present scope.
It suffices to treat the inputs as oracular advice.

\fi

\M{2}The program will split the proof into many pieces.
For each piece $Z(p_i)$, it will either show
that $Z(p_i) \intersect D$ is empty or show that
$(s(x_0),c(x_1,x_2))$ is not minimal for any $x \in Z(p_i)$.
In the second case, this is an exhibition that (i) or (ii) does not hold:
a word $a$ in the free group generated by the symbols $f$ and $w$
such that
$g \ne I$, $g \ne -I$,
and either
(i) $\abs{L(g)} < \abs{L(f)}$
or
(ii) $\abs{L_f(g)} < \abs{L_f(w)}$
whenever
$f = s(x_0), w = c(x_1, x_2)$,
$g$ is the corresponding product,
and $x \in Z(p_i)$.

If we treat $L(f)$, $L(g)$, $L_f(w)$, and $L_f(g)$
as functions from $Z(p_i)$ to $\Complex$,
the problem can be thought of in terms of bounding the range
of $\abs{L(g)/L(f)}$ and $\abs{L_f(g)/L_f(w)}$.

To get these bounds, we work with local complex-affine approximations:
given $(f,f_0,f_1,f_2, \epsilon)$,
the class of all functions $g : H \ra \Complex$
such that $\abs{g(x) - (f + f_0 x_0 + f_1 x_1 + f_2 x_2)} < \epsilon$
for all $x \in H$,
where $H$ is $D^3$:
$H = \{z : \abs{z_i} <= 1, \hbox{ for } i=0,1,2\}$.

Each of the functions we use is constructed from simple functions
using only addition, subtraction, multiplication, division, and square root.
At each stage in the construction,
the program calculates a local complex-affine approximation which
contains the class of possible result functions, given
local complex-affine approximation of possible input function(s).

\fi

\M{3}The program has a simple structure.
In \PB{\\{verify}}, the problem is broken into pieces,
corresponding to strings $p_i$ such that $Z(p_i)$ can be treated
with a single calculation.

\PB{\\{roundoff}} discusses the properties of computer arithmetic.

The remainder of the program is presented in reverse order,
starting with the highest-level concepts and ending with the most basic.

\PB{\\{inequalityHolds}} uses the specified inequality to prove
that the specified piece is MNG-free.
To do this, it uses two abstractions:
approximate complex $1$-jets (ACJ), and 2x2 matrices of ACJ.

The \PB{\&{SL2ACJ}} class reduces operations on matrices of ACJ
to operations on ACJ. It also defines the length and
ortholength functions and the $s$ and $c$ maps.

The \PB{\&{ACJ}} class defines operations on ACJ in terms of operations
on intervals of complex numbers.

The \PB{\&{AComplex}} and \PB{\&{XComplex}} classes define
operations on intervals of complex numbers.

\fi

\N{1}{4}Covering the parameter space.

\PB{\\{verify}} pieces together the results of
\PB{\\{inequalityHolds}} to cover larger regions.

Codes from the input mean one of three things, as far as \PB{\\{verify}} is
concerned.
When $\PB{\\{code}} < 0$, \PB{\\{where}} is an exceptional case,
to be handled by some other entity, so
\PB{\\{verify}} prints \PB{\\{where}} and returns.
When $\PB{\\{code}} = 0$, \PB{\\{where}} is a composite case, so
\PB{\\{verify}} calls itself, first on \PB{\\{where0}} and then on \PB{%
\\{where1}}.
When $\PB{\\{code}} > 0$, \PB{\\{where}} is an atomic case,
so \PB{\\{verify}} uses \PB{\\{inequalityHolds}}
to show that $Z(\PB{\\{where}})$ is MNG-free.
If this isn't possible, \PB{\\{verify}} tries the same code
on two parts of \PB{\\{where}}.

If \PB{$\\{autocode}>\T{0}$}, then \PB{\\{verify}} doesn't read from the input,
and uses \PB{\\{autocode}} instead.

\lemma
If \PB{$\\{verify}(\\{where},\\{depth},\\{code})$} finishes, and prints
``$m_0 \dots m_k$'', then
$Z(\PB{\\{where}}) - \Union_i Z(m_i)$ is MNG-free.
\endlemma

\Y\B\4\X4:Definition of \PB{\\{verify}}\X${}\E{}$\6
\&{void} \\{verify}(\&{char} ${}{*}\\{where},\39{}$\&{int} \\{depth}${},\39{}$%
\&{int} \\{autocode})\1\1\2\2\6
${}\{{}$\1\6
\&{int} \\{code};\7
\&{if} ${}(\\{depth}\G\.{MAXDEPTH}){}$\5
${}\{{}$\1\6
${}\\{where}[\\{depth}]\K\.{'\\0'};{}$\6
${}\\{fprintf}(\\{stderr},\39\.{"verify:\ fatal\ error}\)\.{\ at\ \%s\\n"},\39%
\\{where});{}$\6
\\{exit}(\T{1});\6
\4${}\}{}$\2\6
\&{if} ${}(\\{autocode}\E\T{0}){}$\5
${}\{{}$\1\6
${}\\{scanf}(\.{"\%d"},\39{\AND}\\{code});{}$\6
\4${}\}{}$\2\6
\&{else}\5
${}\{{}$\1\6
${}\\{code}\K\\{autocode};{}$\6
\4${}\}{}$\2\6
${}\\{where}[\\{depth}]\K\.{'\\0'};{}$\6
\&{if} ${}(\\{code}<\T{0}){}$\5
${}\{{}$\1\6
${}\\{printf}(\.{"\%s\ "},\39\\{where});{}$\6
\4${}\}{}$\2\6
\&{else} \&{if} ${}(\\{code}\I\T{0}\W\\{inequalityHolds}(\\{inequalityFor}(%
\\{code}),\39\\{where},\39\\{depth})){}$\5
${}\{{}$\C{ where is MNG-free }\6
\,${}\}{}$\6
\&{else}\5
${}\{{}$\1\6
${}\\{where}[\\{depth}]\K\.{'0'};{}$\6
${}\\{verify}(\\{where},\39\\{depth}+\T{1},\39\\{code});{}$\6
${}\\{where}[\\{depth}]\K\.{'1'};{}$\6
${}\\{verify}(\\{where},\39\\{depth}+\T{1},\39\\{code});{}$\6
\4${}\}{}$\2\6
\4${}\}{}$\2\par
\U73.\fi

\M{5}Positive codes refer to line numbers in the file ``conditionlist'',
which lists all of the inequalities used, one per line.
Given a code number, \PB{\\{inequalityFor}} returns the corresponding
inequality
from the file.
The first time it's called,
\PB{\\{inequalityFor}} also reads the file into \PB{\\{inequalities}},
and initializes an array of pointers to the beginning of each line.

\Y\B\4\X5:Definition of \PB{\\{inequalityFor}}\X${}\E{}$\6
\&{const} \&{char} ${}{*}\\{inequalityFor}{}$(\&{int} \\{code})\1\1\2\2\6
${}\{{}$\1\6
\&{const} \&{int} \\{max\_n\_inequalities}${}\K\T{13200};{}$\6
\&{const} \&{int} \\{max\_inequalities\_size}${}\K\T{300000};{}$\6
\&{static} \&{int} \\{n\_inequalities}${}\K\T{0};{}$\6
\&{static} \&{char} \\{inequalities}[\\{max\_inequalities\_size}];\6
\&{static} \&{char} ${}{*}\\{inequalityIndex}[\\{max\_n\_inequalities}];{}$\7
\&{if} ${}(\\{n\_inequalities}\E\T{0}){}$\5
${}\{{}$\1\6
\&{FILE} ${}{*}\\{fp}\K\\{fopen}(\.{"conditionlist"},\39\.{"r"});{}$\7
\&{if} ${}(\\{fp}\E\NULL){}$\5
${}\{{}$\1\6
${}\\{fprintf}(\\{stderr},\39\.{"can't\ open\ conditio}\)\.{nlist\\n"});{}$\6
\\{exit}(\T{1});\6
\4${}\}{}$\2\7
\&{int} \\{n\_read}${}\K\\{fread}(\\{inequalities},\39\T{1},\39\\{max%
\_inequalities\_size},\39\\{fp});{}$\6
\&{char} ${}{*}\\{ip}\K\\{inequalities};{}$\7
${}\\{n\_inequalities}\K\T{1};{}$\6
${}\\{inequalityIndex}[\\{n\_inequalities}\PP]\K\\{inequalities};{}$\6
\&{while} ${}(\\{n\_inequalities}<\\{max\_n\_inequalities}\W\\{ip}<%
\\{inequalities}+\\{n\_read}-\T{1}){}$\5
${}\{{}$\1\6
\&{if} ${}({*}\\{ip}\E\.{'\\n'}){}$\1\5
${}\\{inequalityIndex}[\\{n\_inequalities}\PP]\K\\{ip}+\T{1};{}$\2\6
${}\\{ip}\PP;{}$\6
\4${}\}{}$\2\6
\\{fclose}(\\{fp});\6
\4${}\}{}$\2\6
\&{if} ${}(\\{code}<\T{1}\V\\{code}\G\\{n\_inequalities}){}$\5
${}\{{}$\1\6
${}\\{fprintf}(\\{stderr},\39\.{"code\ \%d\ out\ of\ rang}\)\.{e\ [1,\%d]\ in\
inequali}\)\.{tyFor\\n"},\39\\{code},\39\\{n\_inequalities});{}$\6
\\{exit}(\T{1});\6
\4${}\}{}$\2\6
\&{return} \\{inequalityIndex}[\\{code}];\6
\4${}\}{}$\2\par
\U73.\fi

\M{6}The \PB{\\{main}} program is almost trivial.
\Y\B\4\X6:Definition of \PB{\\{main}}\X${}\E{}$\6
\\{main}(\&{int} \\{argc}${},\39{}$\&{char} ${}{*}{*}\\{argv}){}$\1\1\2\2\6
${}\{{}$\1\6
\&{if} ${}(\\{argc}\I\T{2}){}$\5
${}\{{}$\1\6
${}\\{fprintf}(\\{stderr},\39\.{"Usage:\ \%s\ position\ }\)\.{<\ data\\n"},\39%
\\{argv}[\T{0}]);{}$\6
\\{exit}(\T{1});\6
\4${}\}{}$\2\7
\&{char} \\{where}[\.{MAXDEPTH}];\6
\&{int} \\{depth};\7
\&{for} ${}(\\{depth}\K\T{0};{}$ ${}\\{argv}[\T{1}][\\{depth}]\I\.{'\\0'};{}$
${}\\{depth}\PP){}$\5
${}\{{}$\1\6
\&{if} ${}(\\{argv}[\T{1}][\\{depth}]\I\.{'0'}\W\\{argv}[\T{1}][\\{depth}]\I%
\.{'1'}){}$\5
${}\{{}$\1\6
${}\\{fprintf}(\\{stderr},\39\.{"bad\ position\ \%s\\n"},\39\\{argv}[%
\T{1}]);{}$\6
\\{exit}(\T{1});\6
\4${}\}{}$\2\6
${}\\{where}[\\{depth}]\K\\{argv}[\T{1}][\\{depth}];{}$\6
\4${}\}{}$\2\6
${}\\{where}[\\{depth}]\K\.{'\\0'};{}$\6
${}\\{printf}(\.{"verified\ corona\ \%s}\)\.{\ -\ \{\ "},\39\\{where});{}$\6
\\{initialize\_roundoff}(\,);\6
${}\\{verify}(\\{where},\39\\{depth},\39\T{0});{}$\6
\&{if} ${}(\R\\{roundoff\_ok}(\,)){}$\5
${}\{{}$\1\6
\\{printf}(\.{".\ underflow\ may\ hav}\)\.{e\ occurred\\n"});\6
\\{exit}(\T{1});\6
\4${}\}{}$\2\6
\\{printf}(\.{"\}.\\n"});\6
\\{exit}(\T{0});\6
\4${}\}{}$\2\par
\U73.\fi

\M{7}\B\X7:Definition of \PB{\.{MAXDEPTH}}\X${}\E{}$\6
\&{const} \&{int} \.{MAXDEPTH}${}\K\T{200}{}$;\par
\U73.\fi

\N{1}{8}Computer arithmetic.
The arithmetic operations defined on a computer are of necessity inexact.
In this section, we discuss the relevant properties of computer
arithmetic.
We also define the constants involved, and the procedures
needed to control the floating-point behavior.

The model we use for floating-point arithmetic is the IEEE-754
double-precision standard; it is used on all of the computers the computation
is run on.

It would be possible to regard floating-point numbers
as a subset of the rationals.
Instead, we regard them as separate objects, and use a map
$S : \PB{\&{double}} \ra \Real$.

This program does not allow underflow.
We ask the system to signal an error if underflow occurs;
and the error bounds we use are only valid when there is no underflow.

In order to understand the error bounds, we need to introduce
some properties of floating-point arithmetic.
The IEEE standard implies (assuming there is no underflow)
that the error of the operations
\PB{$+$}, \PB{$-$}, \PB{$*$}, \PB{$/$} and \PB{\\{sqrt}} is bounded by $\PB{%
\.{EPS}}/2$ times
the absolute value of the result.  More specifically, there is
a finite set of numbers which are representable on the computer,
and the result of these operations is always the closest representable
number to the true solution.
The standard also implies that if $\PB{\|n}$ is not too large and $x$ is
representable, then $1+n \PB{\.{EPS}}$, $2^n x$ and $-x$ are representable
and that
$\reps{\PB{$(\T{1}+\.{EPS})*\|x$}} > \reps{x}$ and $\reps{\PB{$(\T{1}-\.{EPS})*%
\|x$}} < \reps{\PB{\|x}}$
for $x \neq 0$.

Finally, according to the documentation provided for the \PB{\\{hypot}}
function,
there cannot be a representable number between
$\reps{\PB{\\{hypot}(\|x)}}$ and $\sqrt{\reps{x}}$.

\Y\B\4\X8:Definition of \PB{\.{EPS}} and \PB{\.{HALFEPS}}\X${}\E{}$\6
\8\#\&{define} \.{EPS} \5\.{DBL\_EPSILON}\6
\8\#\&{define} \.{HALFEPS} \5${}(\.{EPS}/\T{2}){}$\par
\U61.\fi

\M{9}
It is unfortunate that there is no standard way to use the IEEE functions
for floating-point control.  We have to use a different
method for each kind of machine.
\Y\B\4\X9:Declaration of floating-point functions\X${}\E{}$\6
\8\#\&{ifdef} \.{\_\_GNUG\_\_}\6
\&{inline} \&{double} \\{fabs}(\&{double} \|x)\1\1\2\2\6
${}\{{}$\1\6
\&{return} ${}\|x<\T{0}\?{-}\|x:\|x;{}$\6
\4${}\}{}$\2\7
\&{extern} \.{"C"}\1\1\2\2\6
${}\{{}$\6
\8\#\&{endif}\C{ C++ }\1\6
\&{void} \\{initialize\_roundoff}(\,);\6
\&{int} \\{roundoff\_ok}(\,);\6
\8\#\&{ifndef} \\{\_\_sparc\_\_}\6
\&{extern} \&{double} \\{infinity}(\,);\6
\8\#\&{endif}\C{ sparc }\6
\8\#\&{ifdef} \.{\_\_GNUG\_\_}\6
\4${}\}{}$\2\6
\8\#\&{endif}\C{ C++ }\par
\U61.\fi

\M{10}\B\X10:Definition of floating-point functions\X${}\E{}$\6
\8\#\&{ifndef} \\{\_\_sparc\_\_}\6
\&{inline} \&{double} \\{infinity}(\,)\1\1\2\2\6
${}\{{}$\1\6
\&{return} ${}\T{1.0}/\T{0.0};{}$\6
\4${}\}{}$\2\6
\8\#\&{endif}\6
\8\#\&{ifdef} \\{sgi}\6
\8\#\&{include} \.{<sys/fpu.h>}\7
\&{void} \\{initialize\_roundoff}(\,)\1\1\2\2\6
${}\{{}$\1\6
\&{union} \\{fpc\_csr} \\{csr};\7
${}\\{csr}.\\{fc\_word}\K\\{get\_fpc\_csr}(\,);{}$\6
${}\\{csr}.\\{fc\_struct}.\\{en\_underflow}\K\T{1};{}$\6
${}\\{set\_fpc\_csr}(\\{csr}.\\{fc\_word});{}$\6
\4${}\}{}$\2\6
\8\#\&{else}\6
\8\#\&{ifdef} \\{\_\_sparc\_\_}\6
\8\#\&{include} \.{<floatingpoint.h>}\7
\&{void} \\{initialize\_roundoff}(\,)\1\1\2\2\6
${}\{{}$\1\6
${}\\{ieee\_handler}(\.{"set"},\39\.{"underflow"},\39\.{SIGFPE\_ABORT});{}$\6
\4${}\}{}$\2\6
\8\#\&{else}\C{ sparc }\7
\&{void} \\{initialize\_roundoff}(\,)\1\1\2\2\6
${}\{\,\}{}$\6
\8\#\&{endif}\C{ sparc }\6
\8\#\&{endif}\C{ sgi }\6
\8\#\&{if} \&{defined} (\\{sgi})${}\V{}$\&{defined} (\\{\_\_sparc\_\_})\7
\&{int} \\{roundoff\_ok}(\,)\1\1\2\2\6
${}\{{}$\1\6
\&{return} \T{1};\6
\4${}\}{}$\2\6
\8\#\&{else}\C{ sgi \PB{} sparc }\6
\8\#\&{if} \&{defined} (\.{AIX})\7
\&{int} \\{roundoff\_ok}(\,)\1\1\2\2\6
${}\{{}$\1\6
\&{return} ${}\\{fp\_underflow}(\,)\E\T{0};{}$\6
\4${}\}{}$\2\6
\8\#\&{else}\C{ AIX }\7
\&{int} \\{roundoff\_ok}(\,)\1\1\2\2\6
${}\{{}$\1\6
\&{return} \T{0};\6
\4${}\}{}$\2\6
\8\#\&{endif}\C{ AIX }\6
\8\#\&{endif}\C{ sgi \PB{} sparc }\par
\U62.\fi

\N{1}{11}Proving inequalities.
\lemma
If inequalityHolds\PB{$(\\{what},\\{where})$} returns \PB{\T{1}}, then $Z(\PB{%
\\{where}})$ is MNG-free.
\endlemma

\Y\B\4\X11:Definition of \PB{\\{inequalityHolds}}\X${}\E{}$\6
\&{int} \\{inequalityHolds}(\&{const} \&{char} ${}{*}\\{code},\39{}$\&{const} %
\&{char} ${}{*}\\{where},\39{}$\&{int} \\{depth})\1\1\2\2\6
${}\{{}$\1\6
\&{double} \\{pos}[\T{6}]${},{}$ \\{size}[\T{6}]${},{}$ \\{scale}[\T{6}];\6
\&{double} \\{min\_d};\6
\&{ACJ} ${}\\{max\_angle}(\T{0},\39\T{0},\39\T{0},\39\T{0},\39\T{0});{}$\7
\&{if} ${}(\R\\{covers\_hole}(\\{where},\39\\{depth},\39{\AND}\\{min\_d},\39{%
\AND}\\{max\_angle})){}$\5
${}\{{}$\1\6
\&{return} (\T{1});\6
\4${}\}{}$\2\6
\X12:Find \PB{\\{pos}} and \PB{\\{size}} of \PB{$\\{where},\\{depth}$}\X\7
\&{ACJ} ${}\\{along}((\&{XComplex}(\\{pos}[\T{0}],\39\\{pos}[\T{3}])),\39%
\&{XComplex}(\\{size}[\T{0}],\39\\{size}[\T{3}]),\39\T{0},\39\T{0},\39%
\T{0});{}$\6
\&{ACJ} ${}\\{ortho}((\&{XComplex}(\\{pos}[\T{1}],\39\\{pos}[\T{4}])),\39\T{0},%
\39\&{XComplex}(\\{size}[\T{1}],\39\\{size}[\T{4}]),\39\T{0},\39\T{0});{}$\6
\&{ACJ} ${}\\{whirle}((\&{XComplex}(\\{pos}[\T{2}],\39\\{pos}[\T{5}])),\39%
\T{0},\39\T{0},\39\&{XComplex}(\\{size}[\T{2}],\39\\{size}[\T{5}]),\39%
\T{0});{}$\7
\&{switch} (\\{code}[\T{0}])\5
${}\{{}$\1\6
\4\&{case} \.{'s'}:\SHC{ short :            $\abs{\PB{\\{along}}} <
e^{0.0978...}$ }\6
\&{return} ${}\\{absUB}(\\{along})<\T{1.10274};{}$\6
\4\&{case} \.{'l'}:\SHC{ long :             $\abs{\PB{\\{along}}} >
e^{1.28978...}$ }\6
\&{return} ${}\\{absLB}(\\{along})>\T{3.63201};{}$\6
\4\&{case} \.{'n'}:\SHC{ near :             $\abs{\PB{\\{ortho}}} < min_d$ }\6
\&{return} ${}\\{absUB}(\\{ortho})<\\{min\_d};{}$\7
\4\&{case} \.{'f'}:\SHC{ far :              $visangle(\PB{\\{ortho}}) <
max_angle$ }\6
\&{ACJ} \\{angle}${}\K\\{horizon}(\\{ortho});{}$\7
\&{return} ${}\\{larger\_angle}(\\{max\_angle},\39\\{angle});{}$\6
\4\&{case} \.{'W'}:\SHC{ whirle small :     $\abs{\PB{\\{whirle}}} < 1$ }\6
\&{return} ${}\\{absUB}(\\{whirle})<\T{1};{}$\7
\4\&{case} \.{'w'}:\SHC{ whirle big :    $\abs{\PB{\\{whirle}}^2} > \abs{\PB{%
\\{along}}}$ }\6
\&{double} \\{wh}${}\K\\{absLB}(\\{whirle});{}$\7
\&{return} ${}(\T{1}-\.{EPS})*\\{wh}*\\{wh}>\\{absUB}(\\{along});{}$\6
\4\&{default}:\6
${}\{{}$\1\6
\&{SL2ACJ} ${}\|g(\\{evaluateWord}(\\{code}+\T{1},\39\\{along},\39\\{ortho},\39%
\\{whirle}));{}$\6
\&{ACJ} \|l${}\K\\{length}(\|g);{}$\7
\&{switch} (\\{code}[\T{0}])\5
${}\{{}$\1\6
\4\&{case} \.{'O'}:\SHC{ ortho : $g$ has larger visual angle than $ortho$ and
$g$ not a power of $f$ }\6
\\{assert}(\T{0});\6
\&{return} (\T{0});\SHC{ never used, and doesn't work for vol3 }\6
\4\&{case} \.{'L'}:\SHC{ length :       $\abs{\PB{\\{length}}(g)} < \abs{\PB{%
\\{length}}(w)}$ and $g$ nontrivial }\6
\&{return} ${}\\{notIdentity}(\|g)\W\\{absUB}(\|l/\\{along})<\T{1}\W\\{absLB}(%
\|l*\\{along})>\T{1};{}$\6
\4\&{case} \.{'2'}:\SHC{ identity :     $\abs{\PB{\\{length}}(g)} < \abs{\PB{%
\\{length}}(w)}$ and \PB{\\{code}} is simple }\6
\&{return} ${}\\{wordImpliesCommuting}(\\{code}+\T{1})\W\\{absUB}(\|l/%
\\{along})<\T{1}\W\\{absLB}(\|l*\\{along})>\T{1};{}$\6
\4\&{default}:\5
\\{assert}(\T{0});\6
\&{return} (\T{0});\6
\4${}\}{}$\2\6
\4${}\}{}$\2\6
\4${}\}{}$\2\6
\4${}\}{}$\2\par
\U72.\fi

\M{12}We may take the values of scale to be exact, since $pow(2, (5-i)/6.0)$
takes
the same values on all of the machines on which the program was run.
\Y\B\4\X12:Find \PB{\\{pos}} and \PB{\\{size}} of \PB{$\\{where},\\{depth}$}%
\X${}\E{}$\6
\&{for} (\&{int} \|i${}\K\T{0};{}$ ${}\|i<\T{6};{}$ ${}\|i\PP){}$\5
${}\{{}$\1\6
${}\\{pos}[\|i]\K\T{0};{}$\6
${}\\{size}[\|i]\K\T{4};{}$\6
${}\\{scale}[\|i]\K\\{pow}(\T{2},\39(\T{5}-\|i)/\T{6.0});{}$\6
\4${}\}{}$\2\6
\&{for} (\&{int} \|d${}\K\T{0};{}$ ${}\|d<\\{depth};{}$ ${}\|d\PP){}$\5
${}\{{}$\1\6
${}\\{size}[\|d\MOD\T{6}]\MRL{{/}{\K}}\T{2};{}$\6
\&{if} ${}(\\{where}[\|d]\E\.{'0'}){}$\5
${}\{{}$\1\6
${}\\{pos}[\|d\MOD\T{6}]\MRL{-{\K}}\\{size}[\|d\MOD\T{6}];{}$\6
\4${}\}{}$\2\6
\&{else} \&{if} ${}(\\{where}[\|d]\E\.{'1'}){}$\5
${}\{{}$\1\6
${}\\{pos}[\|d\MOD\T{6}]\MRL{+{\K}}\\{size}[\|d\MOD\T{6}];{}$\6
\4${}\}{}$\2\6
\&{else}\5
${}\{{}$\1\6
\\{assert}(\T{0});\6
\4${}\}{}$\2\6
\4${}\}{}$\2\6
\&{for} ${}(\|i\K\T{0};{}$ ${}\|i<\T{6};{}$ ${}\|i\PP){}$\5
${}\{{}$\1\6
${}\\{pos}[\|i]\MRL{*{\K}}\\{scale}[\|i];{}$\6
${}\\{size}[\|i]\K(\T{1}+\T{2}*\.{EPS})*(\\{size}[\|i]*\\{scale}[\|i]+%
\.{HALFEPS}*\\{fabs}(\\{pos}[\|i]));{}$\6
\4${}\}{}$\2\par
\Us11\ET15.\fi

\M{13}\B\X13:Definition of \PB{\\{evaluateWord}}\X${}\E{}$\6
\&{SL2ACJ} \\{evaluateWord}(\&{const} \&{char} ${}{*}\\{word},\39{}$\&{const} %
\&{ACJ} ${}{\AND}\\{along},\39{}$\&{const} \&{ACJ} ${}{\AND}\\{ortho},\39{}$%
\&{const} \&{ACJ} ${}{\AND}\\{whirle}){}$\1\1\2\2\6
${}\{{}$\1\6
\&{ACJ} \\{one}(\T{1})${},{}$ \\{zero}(\T{0});\6
\&{SL2ACJ} \|f(\\{shortGenerator}(\\{along}));\6
\&{SL2ACJ} ${}\|w(\\{closeGenerator}(\\{ortho},\39\\{whirle}));{}$\6
\&{SL2ACJ} \|F(\\{inverse}(\|f));\6
\&{SL2ACJ} \|W(\\{inverse}(\|w));\6
\&{SL2ACJ} ${}\|g(\\{one},\39\\{zero},\39\\{zero},\39\\{one});{}$\6
\&{int} \|i;\7
\&{for} ${}(\|i\K\T{1};{}$ ${}\\{word}[\|i]\I\.{')'};{}$ ${}\|i\PP){}$\5
${}\{{}$\1\6
\&{switch} (\\{word}[\|i])\5
${}\{{}$\1\6
\4\&{case} \.{'w'}:\5
${}\|g\K\|g*\|w;{}$\6
\&{break};\6
\4\&{case} \.{'W'}:\5
${}\|g\K\|g*\|W;{}$\6
\&{break};\6
\4\&{case} \.{'f'}:\5
${}\|g\K\|g*\|f;{}$\6
\&{break};\6
\4\&{case} \.{'F'}:\5
${}\|g\K\|g*\|F;{}$\6
\&{break};\6
\4\&{default}:\5
\\{assert}(\T{0});\6
\4${}\}{}$\2\6
\4${}\}{}$\2\6
\&{return} \|g;\6
\4${}\}{}$\2\par
\U72.\fi

\M{14}For any integers $k,l$, $f^k w^l = 1$ implies that $f$ and $w$ commute.
If \PB{\\{wordImpliesCommuting}(\\{word})} returns $1$, then $word$
is of the form $f^k w^l$.
\Y\B\4\X14:Definition of \PB{\\{wordImpliesCommuting}}\X${}\E{}$\6
\&{int} \\{wordImpliesCommuting}(\&{const} \&{char} ${}{*}\\{word}){}$\1\1\2\2\6
${}\{{}$\1\6
\&{for} ${}(\\{word}\PP;{}$ ${}\\{word}[\T{0}]\I\.{')'}\W\\{word}[\T{1}]\I%
\.{')'};{}$ ${}\\{word}\PP){}$\5
${}\{{}$\1\6
\&{if} ${}((\\{word}[\T{0}]\E\.{'f'}\W\\{word}[\T{1}]\E\.{'f'})\V(\\{word}[%
\T{0}]\E\.{'F'}\W\\{word}[\T{1}]\E\.{'F'})\V(\\{word}[\T{0}]\E\.{'w'}\W%
\\{word}[\T{1}]\E\.{'w'})\V(\\{word}[\T{0}]\E\.{'W'}\W\\{word}[\T{1}]\E\.{'W'})%
\V(\\{word}[\T{0}]\E\.{'f'}\W\\{word}[\T{1}]\E\.{'w'})\V(\\{word}[\T{0}]\E%
\.{'f'}\W\\{word}[\T{1}]\E\.{'W'})\V(\\{word}[\T{0}]\E\.{'F'}\W\\{word}[\T{1}]%
\E\.{'w'})\V(\\{word}[\T{0}]\E\.{'F'}\W\\{word}[\T{1}]\E\.{'W'})){}$\1\5
;\C{ word is OK -- keep checking }\2\6
\&{else}\1\5
\&{return} \T{0};\2\6
\4${}\}{}$\2\6
\&{return} \T{1};\6
\4${}\}{}$\2\par
\U72.\fi

\M{15}In this version of the program, we are only interested in boxes
which could contain alternate images of manifolds which could lie in the
exceptional boxes of the main search.  If \PB{\\{covers\_hole}} returns 0,
then \PB{$\\{where},\\{depth}$} can't contain any such images, and so no
further work
needs to be done.  Otherwise, it fills in the minimum absolute value
of $d$ and the maximum visual angle for which the search needs to be done.

To do this, it uses an array of structures which give the location,
minimum $d$, and maximum visual angle for each exceptional case.

\Y\B\4\X15:Definition of \PB{\\{covers\_hole}}\X${}\E{}$\6
\&{ACJ} ${}\\{quarter}(\&{XComplex}(\T{0},\39\T{1}),\39\T{0},\39\T{0},\39\T{0},%
\39\T{0});{}$\6
\&{ACJ} ${}\\{third}(\&{XComplex}({-}\T{0.5},\39\\{sqrt}(\T{0.75})),\39\T{0},%
\39\T{0},\39\T{0},\39\.{EPS});{}$\6
\&{ACJ} ${}\\{vol3}(\&{XComplex}({-}\T{0.3933},\39\T{0.91942}),\39\T{0},\39%
\T{0},\39\T{0},\39\T{1.415}*\.{EPS});{}$\6
\&{struct} \&{hole} ${}\{{}$\1\6
\&{char} ${}{*}\\{where};{}$\6
\&{double} \\{min\_d};\6
\&{ACJ} \\{max\_angle};\2\6
${}\}{}$ \\{holes}[\,]${}\K\{\{\.{"0010001100011101100}\)%
\.{11101000110111110100}\)\.{01011000010001110110}\)\.{10011010010001101010}\)%
\.{11000000100000"},\39\T{1},\39\\{third}\},\39\{\.{"0010001101010100101}\)%
\.{01010110001100101110}\)\.{11110000110101011110}\)\.{0100000010001111100"},%
\39\T{1},\39\\{third}\},\39\{\.{"1110000000010001100}\)\.{11011101101011000111}%
\)\.{10101111000110011111}\)\.{11001101100000000100}\)\.{010100010"},\39\T{1},%
\39\\{third}\},\39\{\.{"1110000000010001100}\)\.{11001001111101010011}\)%
\.{11011011011110110001}\)\.{11111101101101000011}\)\.{1101"},\39\T{1},\39%
\\{third}\},\39\{\.{"1110000000010001100}\)\.{11001001111101010111}\)%
\.{11001011001110100001}\)\.{10111100101100000010}\)\.{1101"},\39\T{1},\39%
\\{third}\},\39\{\.{"0010001101111100011}\)\.{01001010101011001011}\)%
\.{01101011110110110000}\)\.{11011010001110100011}\)\.{10101100101110111011}\)%
\.{1110100"},\39\T{1},\39\\{vol3}\},\39\{\.{"0010011101101100001}\)%
\.{01000010100011000011}\)\.{01001011010110010000}\)\.{01011000001100100001}\)%
\.{10100100100110110011}\)\.{1100100"},\39\T{1},\39\\{vol3}\},\39\{%
\.{"0010001100011101110}\)\.{01111000101111111101}\)\.{11110011100111100000}\)%
\.{11110111101111"},\39\T{1},\39\\{third}\},\39\{\.{"0010011100001101100}\)%
\.{01110000100111110101}\)\.{11010011000111000000}\)\.{01110101101101"},\39%
\T{1},\39\\{third}\},\39\{\.{"1110000000010001111}\)\.{11111110101001111011}\)%
\.{11101011111111111000}\)\.{10010110001110"},\39\T{1},\39\\{third}\},\39\{%
\.{"1110010000000001101}\)\.{11110110100001110011}\)\.{11001011011111011000}\)%
\.{00010100001100"},\39\T{1},\39\\{third}\},\39\{\T{0},\39\T{0},\39\T{0}\}%
\};{}$\7
\&{void} \\{compute\_min\_d}(\&{hole} ${}{\AND}\|h){}$\1\1\2\2\6
${}\{{}$\1\6
\&{double} \\{pos}[\T{6}]${},{}$ \\{size}[\T{6}]${},{}$ \\{scale}[\T{6}];\6
\&{char} ${}{*}\\{where}\K\|h.\\{where};{}$\6
\&{int} \\{depth}${}\K\\{strlen}(\\{where});{}$\7
\X12:Find \PB{\\{pos}} and \PB{\\{size}} of \PB{$\\{where},\\{depth}$}\X\7
\&{ACJ} ${}\\{ortho}((\&{XComplex}(\\{pos}[\T{1}],\39\\{pos}[\T{4}])),\39\T{0},%
\39\&{XComplex}(\\{size}[\T{1}],\39\\{size}[\T{4}]),\39\T{0},\39\T{0});{}$\7
${}\|h.\\{min\_d}\K\\{absLB}(\\{ortho});{}$\6
\4${}\}{}$\2\7
\&{int} \\{covers\_hole}(\&{const} \&{char} ${}{*}\\{where},\39{}$\&{int} %
\\{depth}${},\39{}$\&{double} ${}{*}\\{min\_d},\39{}$\&{ACJ} ${}{*}\\{max%
\_angle}){}$\1\1\2\2\6
${}\{{}$\1\6
\&{int} \|i${},{}$ \|j;\7
${}{*}\\{min\_d}\K\T{4};{}$\6
${}{*}\\{max\_angle}\K\\{quarter};{}$\6
\&{for} ${}(\|i\K\T{0};{}$ ${}\\{holes}[\|i].\\{where};{}$ ${}\|i\PP){}$\5
${}\{{}$\1\6
\&{if} ${}(\\{holes}[\|i].\\{min\_d}\E\T{1}){}$\1\5
\\{compute\_min\_d}(\\{holes}[\|i]);\2\6
\&{if} ${}(\\{holes}[\|i].\\{max\_angle}.\|f.\\{re}\E\\{vol3}.\|f.\\{re}\W\R%
\\{strcmp}(\\{where},\39\\{holes}[\|i].\\{where})){}$\1\5
\&{return} (\T{0});\2\7
\&{int} \\{max\_j}${}\K\\{strlen}(\\{holes}[\|i].\\{where});{}$\7
\&{if} ${}(\\{max\_j}>\\{depth}){}$\1\5
${}\\{max\_j}\K\\{depth};{}$\2\6
\&{for} ${}(\|j\K\T{0};{}$ ${}\|j<\\{max\_j}\W\|j<\\{depth};{}$ ${}\|j\MRL{+{%
\K}}\T{3}){}$\1\6
\&{if} ${}(\\{where}[\|j]\I\\{holes}[\|i].\\{where}[\|j]){}$\1\5
\&{break};\2\2\6
\&{if} ${}(\|j\G\\{max\_j}){}$\5
${}\{{}$\1\6
\&{if} ${}(\\{holes}[\|i].\\{min\_d}<{*}\\{min\_d}){}$\1\5
${}{*}\\{min\_d}\K\\{holes}[\|i].\\{min\_d};{}$\2\6
\&{if} ${}(\\{larger\_angle}(\\{holes}[\|i].\\{max\_angle},\39{*}\\{max%
\_angle})){}$\1\5
${}{*}\\{max\_angle}\K\\{holes}[\|i].\\{max\_angle};{}$\2\6
\4${}\}{}$\2\6
\4${}\}{}$\2\6
\&{return} ${}{*}\\{min\_d}\Z\T{3};{}$\6
\4${}\}{}$\2\par
\U72.\fi

\M{16}\PB{\\{horizon}(\\{ortho})} returns a complex number whose argument is
the
minimum visual angle needed to separate the main geodesic and its
image under translation by \PB{\\{ortho}}.  More exactly, it returns the square
of the parameter for the complex translation along the core geodesic
which maps the common perpindicular to the tangent line.

\Y\B\4\X16:Definition of \PB{\\{horizon}}\X${}\E{}$\6
\&{ACJ} \\{horizon}(\&{ACJ} ${}{\AND}\\{ortho}){}$\1\1\2\2\6
${}\{{}$\1\6
\&{if} ${}(\\{ortho}.\|f.\\{re}<\T{0}){}$\1\5
${}\\{ortho}\K{-}\\{ortho};{}$\2\7
\&{ACJ} \|r${}\K\\{ortho}*(\\{ortho}-\T{6})+\T{1};{}$\6
\&{ACJ} \|d${}\K(\\{ortho}*({-}\T{4})+\T{4})*\\{sqrt}({-}\\{ortho});{}$\6
\&{AComplex} \|x${}\K\|r.\|f/\|d.\|f;{}$\6
\&{ACJ} ${}\|h(\T{0},\39\T{0},\39\T{0},\39\T{0},\39\T{0});{}$\7
\&{if} ${}(\|x.\|z.\\{re}>\T{0}){}$\5
${}\{{}$\1\6
${}\|h\K(\|r+\|d)/((\\{ortho}+\T{1})*(\\{ortho}+\T{1}));{}$\6
\4${}\}{}$\2\6
\&{else}\5
${}\{{}$\1\6
${}\|h\K(\|r-\|d)/((\\{ortho}+\T{1})*(\\{ortho}+\T{1}));{}$\6
\4${}\}{}$\2\6
\&{if} ${}(\\{ortho}.\|f.\\{re}<(\T{1}+\.{EPS})*(\\{size}(\\{ortho})+\\{ortho}.%
\|e)){}$\1\5
${}\|h\K\&{ACJ}(\|h.\|f,\39\T{0},\39\T{0},\39\T{0},\39(\T{1}+\.{EPS})*(%
\\{size}(\|h)+\|h.\|e));{}$\2\6
\&{return} \|h;\6
\4${}\}{}$\2\par
\U72.\fi

\M{17}If \PB{$\\{larger\_angle}(\|x,\|y)$} returns 1, then the absolute value
of the
argument of $x$ is always greater than that of $y$.
\Y\B\4\X17:Definition of \PB{\\{larger\_angle}}\X${}\E{}$\6
\&{int} \\{larger\_angle}(\&{ACJ} ${}{\AND}\|x,\39{}$\&{ACJ} ${}{\AND}\|y){}$\1%
\1\2\2\6
${}\{{}$\1\6
\&{ACJ} ${}\\{xy}(\T{0},\39\T{0},\39\T{0},\39\T{0},\39\T{0});{}$\7
\&{if} ${}(\|x.\|f.\\{im}>(\T{1}+\.{EPS})*(\\{size}(\|x)+\|x.\|e)){}$\5
${}\{{}$\1\6
\&{if} ${}(\|y.\|f.\\{im}>(\T{1}+\.{EPS})*(\\{size}(\|y)+\|y.\|e)){}$\1\5
${}\\{xy}\K\|x/\|y;{}$\2\6
\&{if} ${}({-}\|y.\|f.\\{im}>(\T{1}+\.{EPS})*(\\{size}(\|y)+\|y.\|e)){}$\1\5
${}\\{xy}\K\|x*\|y;{}$\2\6
\4${}\}{}$\2\6
\&{if} ${}({-}\|x.\|f.\\{im}>(\T{1}+\.{EPS})*(\\{size}(\|x)+\|x.\|e)){}$\5
${}\{{}$\1\6
\&{if} ${}(\|y.\|f.\\{im}>(\T{1}+\.{EPS})*(\\{size}(\|y)+\|y.\|e)){}$\1\5
${}\\{xy}\K{-}\|x*\|y;{}$\2\6
\&{if} ${}({-}\|y.\|f.\\{im}>(\T{1}+\.{EPS})*(\\{size}(\|y)+\|y.\|e)){}$\1\5
${}\\{xy}\K{-}\|x/\|y;{}$\2\6
\4${}\}{}$\2\6
\&{return} ${}\\{xy}.\|f.\\{im}>(\T{1}+\.{EPS})*(\\{size}(\\{xy})+\\{xy}.%
\|e);{}$\6
\4${}\}{}$\2\par
\U72.\fi

\N{1}{18}Matrices of Approximate Complex $1$-Jets.
This section implements some operations on matrices of \PB{\&{ACJ}}s.
It is used to model intervals of isometries of $H^3$.

An \PB{\&{SL2ACJ}} $g$ is a tuple \PB{$(\|a,\|b,\|c,\|d)$} of \PB{\&{ACJ}}s,
which represents the class $\reps{g}$ of functions
$h : \cube \ra \PSL_2(\Complex)$
such that $h_{0,0} \in \reps{a}$, $h_{0,1} \in \reps{b}$,
$h_{1,0} \in \reps{c}$, and $h_{1,1} \in \reps{d}$.
\Y\B\4\X18:Definition of \PB{\&{SL2ACJ}}\X${}\E{}$\6
\&{struct} \&{SL2ACJ} ${}\{{}$\1\6
\4\&{SL2ACJ}(\,):\5
${}\|a(\T{1}),\39\|b(\T{0}),\39\|c(\T{0}),\39\|d(\T{1}){}$\1\1\2\2\6
${}\{\,\}{}$\7
\4\&{SL2ACJ}(\&{const} \&{ACJ} ${}{\AND}\\{aa},\39{}$\&{const} \&{ACJ} ${}{%
\AND}\\{bb},\39{}$\&{const} \&{ACJ} ${}{\AND}\\{cc},\39{}$\&{const} \&{ACJ}
${}{\AND}\\{dd}):{}$\5
${}\|a(\\{aa}),\39\|b(\\{bb}),\39\|c(\\{cc}),\39\|d(\\{dd}){}$\1\1\2\2\6
${}\{\,\}{}$\7
\&{ACJ} \|a${},{}$ \|b${},{}$ \|c${},{}$ \|d;\2\6
${}\}{}$;\par
\U69.\fi

\M{19}\proposition{M*J}
If \PB{\|x} and \PB{\|y} are \PB{\&{SL2ACJ}}, then
$\reps{\PB{$\|x*\|y$}} \supset \reps{x} \reps{y}$.
\endproposition
\Y\B\4\X19:Definition of \PB{$\|x*\|y$} for \PB{\&{SL2ACJ} \|x${},{}$ \|y}\X${}%
\E{}$\6
\&{return} ${}\&{SL2ACJ}(\|x.\|a*\|y.\|a+\|x.\|b*\|y.\|c,\39\|x.\|a*\|y.\|b+%
\|x.\|b*\|y.\|d,\39\|x.\|c*\|y.\|a+\|x.\|d*\|y.\|c,\39\|x.\|c*\|y.\|b+\|x.\|d*%
\|y.\|d){}$;\par
\U70.\fi

\M{20}\proposition{inverse(M)}
If \PB{\|x} is \PB{\&{SL2ACJ}}, then
\endproposition
$\reps{\PB{\\{inverse}(\|x)}} = \reps{x}^{-1}$.
\Y\B\4\X20:Definition of \PB{\\{inverse}(\|x)} for \PB{\&{SL2ACJ} \|x}\X${}%
\E{}$\6
\&{return} ${}\&{SL2ACJ}(\|x.\|d,\39{-}\|x.\|b,\39{-}\|x.\|c,\39\|x.\|a){}$;\par
\U70.\fi

\M{21}\proposition{orthodist(M)}
If \PB{\|x} is \PB{\&{SL2ACJ}}, then
\endproposition
$\reps{\PB{\\{orthodist}(\|x)}} \supset \olength{\reps{x}}$.
\Y\B\4\X21:Definition of \PB{\\{orthodist}(\|x)} for \PB{\&{SL2ACJ} \|x}\X${}%
\E{}$\6
\&{ACJ} \|t${}\K\|x.\|a*\|x.\|d+\|x.\|b*\|x.\|c;{}$\6
\&{ACJ} \|r${}\K\&{ACJ}(\\{sqrt}(\|t*\|t-\T{1}));{}$\6
\&{ACJ} \\{r1}${}\K\|t+\|r;{}$\7
\&{if} ${}(\\{r1}.\|f.\\{re}*\\{r1}.\|f.\\{re}+\\{r1}.\|f.\\{im}*\\{r1}.\|f.%
\\{im}\G\T{1}){}$\1\5
\&{return} ${}\|t+\|r;{}$\2\6
\&{else}\1\5
\&{return} ${}\|t-\|r{}$;\2\par
\U70.\fi

\M{22}\proposition{length(M)}
If \PB{\|x} is \PB{\&{SL2ACJ}}, then
$\reps{\PB{\\{length}(\|x)}} \supset \tlength{\reps{x}}$.
\endproposition
\Y\B\4\X22:Definition of \PB{\\{length}(\|x)} for \PB{\&{SL2ACJ} \|x}\X${}\E{}$%
\6
\&{ACJ} \|t${}\K(\|x.\|a+\|x.\|d)*\T{0.5};{}$\6
\&{ACJ} \|r${}\K\&{ACJ}(\\{sqrt}(\|t*\|t-\T{1}));{}$\6
\&{ACJ} \\{r1}${}\K\|t+\|r;{}$\7
\&{if} ${}(\\{r1}.\|f.\\{re}*\\{r1}.\|f.\\{re}+\\{r1}.\|f.\\{im}*\\{r1}.\|f.%
\\{im}\G\T{1}){}$\1\5
\&{return} ${}(\|t+\|r)*(\|t+\|r);{}$\2\6
\&{else}\1\5
\&{return} ${}(\|t-\|r)*(\|t-\|r){}$;\2\par
\U70.\fi

\M{23}\proposition{notIdentity(M)}
If \PB{\|x} is \PB{\&{SL2ACJ}}, then
\PB{\\{notIdentity}(\|x)} returns $1$ implies $\pm I \notin \reps{x}$
\endproposition
\Y\B\4\X23:Definition of \PB{\\{notIdentity}(\|x)} for \PB{\&{SL2ACJ} \|x}\X${}%
\E{}$\6
\&{return} ${}\\{absLB}(\|x.\|b)>\T{0}\V\\{absLB}(\|x.\|c)>\T{0}\V(\\{absLB}(%
\|x.\|a-\T{1})>\T{0}\W\\{absLB}(\|x.\|a+\T{1})>\T{0})\V(\\{absLB}(\|x.\|d-%
\T{1})>\T{0}\W\\{absLB}(\|x.\|d+\T{1})>\T{0}){}$;\par
\U70.\fi

\M{24}\proposition{notFPower(M)}
If \PB{\|x} is \PB{\&{SL2ACJ}}, and \PB{\\{notFPower}(\|x)} returns 1,
then for all $k$, $\pm f^k \notin \reps{M}$.
\endproposition
We actually test a stronger condition:
$M \neq \pm shortGenerator(x)$ for all $x$.
\Y\B\4\X24:Definition of \PB{\\{notFPower}(\|x)} for \PB{\&{SL2ACJ} \|x}\X${}%
\E{}$\6
\&{return} ${}\\{absLB}(\|x.\|b)>\T{0}\V\\{absLB}(\|x.\|c)>\T{0}{}$;\par
\U70.\fi

\M{25}\proposition{shortGenerator(J)}
If \PB{\\{z1}} is \PB{\&{ACJ}}, then
$\reps{\PB{\\{shortGenerator}(\|z)}}   \supset\shortGen{\reps{z}}$.
\endproposition
\Y\B\4\X25:Definition of \PB{\\{shortGenerator}(\|z)} for \PB{\&{ACJ} \|z}\X${}%
\E{}$\6
\&{ACJ} \\{sz}${}\K\\{sqrt}(\|z);{}$\6
\&{ACJ} \\{zero}(\T{0});\7
\&{return} ${}\&{SL2ACJ}(\\{sz},\39\\{zero},\39\\{zero},\39\T{1}/\\{sz}){}$;\par
\U70.\fi

\M{26}\proposition{closeGenerator(J,J)}
If \PB{\|x} and \PB{\|z} are \PB{\&{ACJ}}, then
$\reps{\PB{$\\{closeGenerator}(\|x,\|z)$}} \supset\closeGen{\reps{x}}{%
\reps{z}}$.
\endproposition
\Y\B\4\X26:Definition of \PB{$\\{closeGenerator}(\|x,\|z)$} for \PB{\&{ACJ} %
\|x${},{}$ \|z}\X${}\E{}$\6
\&{ACJ} \\{sx}${}\K\\{sqrt}(\|x),{}$ \\{sz}${}\K\\{sqrt}(\|z);{}$\6
\&{ACJ} \\{sh}${}\K(\\{sx}-\T{1}/\\{sx})*\T{0.5};{}$\6
\&{ACJ} \\{ch}${}\K(\\{sx}+\T{1}/\\{sx})*\T{0.5};{}$\7
\&{return} ${}\&{SL2ACJ}(\\{ch}*\\{sz},\39\\{sh}/\\{sz},\39\\{sh}*\\{sz},\39%
\\{ch}/\\{sz}){}$;\par
\U70.\fi

\N{1}{27}Approximate Complex $1$-Jets.
This section implements intervals of Complex $1$-Jets.
It is used to provide rigorous bounds
on the values a complex function takes on a region.

Let $\cube$ be the set of points $(z_0, z_1, z_2) \in \Complex^3$
such that $\abs{z_k} <= 1$ for $k = 0,1,2$.

An \PB{\&{ACJ}} $j$ is a tuple $(f, f_0, f_1, f_2, e)$
with $f,f_0,f_1,f_2 \in \Cdouble$ and $e \in \Rdouble$,
which represents the class $\reps{\PB{\|j}}$ of functions $g : \cube \ra %
\Complex$
such that such that
$$\abs{f(z_0,z_1,z_2) - (f + f_0 z_0 + f_1 z_1 + f_2 z_2)} < e$$
for all $(z_0,z_1,z_2) \in \cube$.  For convenience, we also define
$\reps{x} = \{\PB{\|x}\}$ for $x \in \Complex$

The notation suggests that $f = h(0,0,0)$
and $f_k = \partial_k{h}(0,0,0)$.
This will usually be approximately true.

\Y\B\4\X27:Definition of \PB{\&{ACJ}}\X${}\E{}$\6
\&{struct} \&{ACJ} ${}\{{}$\1\6
\4\&{ACJ}(\&{const} \&{XComplex} ${}{\AND}\\{ff},\39{}$\&{const} \&{XComplex}
${}{\AND}\\{ff0}\K\T{0},\39{}$\&{const} \&{XComplex} ${}{\AND}\\{ff1}\K\T{0},%
\39{}$\&{const} \&{XComplex} ${}{\AND}\\{ff2}\K\T{0},\39{}$\&{double} %
\\{err}${}\K\T{0}):{}$\5
${}\|f(\\{ff}),\39\\{f0}(\\{ff0}),\39\\{f1}(\\{ff1}),\39\\{f2}(\\{ff2}),\39\|e(%
\\{err}),\39\\{size}((\T{1}+\T{2}*\.{EPS})*(\\{absUB}(\\{ff0})+(\\{absUB}(%
\\{ff1})+\\{absUB}(\\{ff2})))){}$\1\1\2\2\6
${}\{\,\}{}$\7
\&{XComplex} \|f;\6
\&{XComplex} \\{f0};\6
\&{XComplex} \\{f1};\6
\&{XComplex} \\{f2};\6
\&{double} \|e;\6
\&{double} \\{size};\2\6
${}\}{}$;\par
\U66.\fi

\M{28}\proposition{-J}
If \PB{\|x} is \PB{\&{ACJ}}, then
$\reps{-x} = -\reps{x}$.
\endproposition
\Y\B\4\X28:Definition of \PB{${-}\|x$} for \PB{\&{ACJ} \|x}\X${}\E{}$\6
\&{return} ${}\&{ACJ}({-}\|x.\|f,\39{-}\|x.\\{f0},\39{-}\|x.\\{f1},\39{-}\|x.%
\\{f2},\39\|x.\|e){}$;\par
\U67.\fi

\M{29}\proposition{J+J}
If \PB{\|x} and \PB{\|y} are \PB{\&{ACJ}}, then
$\reps{x+y} \supset \reps{x} + \reps{y}$.
\endproposition
\Y\B\4\X29:Definition of \PB{$\|x+\|y$} for \PB{\&{ACJ} \|x${},{}$ \|y}\X${}%
\E{}$\6
\&{AComplex} \\{r\_f}${}\K\|x.\|f+\|y.\|f;{}$\6
\&{AComplex} \\{r\_f0}${}\K\|x.\\{f0}+\|y.\\{f0};{}$\6
\&{AComplex} \\{r\_f1}${}\K\|x.\\{f1}+\|y.\\{f1};{}$\6
\&{AComplex} \\{r\_f2}${}\K\|x.\\{f2}+\|y.\\{f2};{}$\6
\&{double} \\{r\_error}${}\K(\T{1}+\T{3}*\.{EPS})*((\|x.\|e+\|y.\|e)+((\\{r%
\_f}.\|e+\\{r\_f0}.\|e)+(\\{r\_f1}.\|e+\\{r\_f2}.\|e)));{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\\{r\_f0}.\|z,\39\\{r\_f1}.\|z,\39\\{r%
\_f2}.\|z,\39\\{r\_error}){}$;\par
\U67.\fi

\M{30}\proposition{J-J}
If \PB{\|x} and \PB{\|y} are \PB{\&{ACJ}}, then
$\reps{x-y} \supset \reps{x} - \reps{y}$.
\endproposition
\Y\B\4\X30:Definition of \PB{$\|x-\|y$} for \PB{\&{ACJ} \|x${},{}$ \|y}\X${}%
\E{}$\6
\&{AComplex} \\{r\_f}${}\K\|x.\|f-\|y.\|f;{}$\6
\&{AComplex} \\{r\_f0}${}\K\|x.\\{f0}-\|y.\\{f0};{}$\6
\&{AComplex} \\{r\_f1}${}\K\|x.\\{f1}-\|y.\\{f1};{}$\6
\&{AComplex} \\{r\_f2}${}\K\|x.\\{f2}-\|y.\\{f2};{}$\6
\&{double} \\{r\_error}${}\K(\T{1}+\T{3}*\.{EPS})*((\|x.\|e+\|y.\|e)+((\\{r%
\_f}.\|e+\\{r\_f0}.\|e)+(\\{r\_f1}.\|e+\\{r\_f2}.\|e)));{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\\{r\_f0}.\|z,\39\\{r\_f1}.\|z,\39\\{r%
\_f2}.\|z,\39\\{r\_error}){}$;\par
\U67.\fi

\M{31}\proposition{J+d}
If \PB{\|x} is \PB{\&{ACJ}} and \PB{\|y} is \PB{\&{double}}, then
$\reps{x+y} \supset \reps{x} + \reps{y}$.
\endproposition
\Y\B\4\X31:Definition of \PB{$\|x+\|y$} for \PB{\&{ACJ} \|x} and \PB{\&{double}
\|y}\X${}\E{}$\6
\&{AComplex} \\{r\_f}${}\K\|x.\|f+\|y;{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\|x.\\{f0},\39\|x.\\{f1},\39\|x.\\{f2},%
\39(\T{1}+\.{EPS})*(\|x.\|e+\\{r\_f}.\|e)){}$;\par
\U67.\fi

\M{32}\proposition{J-d}
If \PB{\|x} is \PB{\&{ACJ}} and \PB{\|y} is \PB{\&{double}}, then
$\reps{x-y} \supset \reps{x} - \reps{y}$.
\endproposition
\Y\B\4\X32:Definition of \PB{$\|x-\|y$} for \PB{\&{ACJ} \|x} and \PB{\&{double}
\|y}\X${}\E{}$\6
\&{AComplex} \\{r\_f}${}\K\|x.\|f-\|y;{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\|x.\\{f0},\39\|x.\\{f1},\39\|x.\\{f2},%
\39(\T{1}+\.{EPS})*(\|x.\|e+\\{r\_f}.\|e)){}$;\par
\U67.\fi

\M{33}\proposition{J*J}
If \PB{\|x} and \PB{\|y} are \PB{\&{ACJ}}, then
$\reps{x*y} \supset \reps{x} \reps{y}$.
\endproposition
\Y\B\4\X33:Definition of \PB{$\|x*\|y$} for \PB{\&{ACJ} \|x${},{}$ \|y}\X${}%
\E{}$\6
\&{double} \\{xdist}${}\K\\{size}(\|x);{}$\6
\&{double} \\{ydist}${}\K\\{size}(\|y);{}$\6
\&{double} \\{ax}${}\K\\{absUB}(\|x.\|f),{}$ \\{ay}${}\K\\{absUB}(\|y.\|f);{}$\6
\&{AComplex} \\{r\_f}${}\K\|x.\|f*\|y.\|f;{}$\6
\&{AComplex} \\{r\_f0}${}\K\|x.\|f*\|y.\\{f0}+\|x.\\{f0}*\|y.\|f;{}$\6
\&{AComplex} \\{r\_f1}${}\K\|x.\|f*\|y.\\{f1}+\|x.\\{f1}*\|y.\|f;{}$\6
\&{AComplex} \\{r\_f2}${}\K\|x.\|f*\|y.\\{f2}+\|x.\\{f2}*\|y.\|f;{}$\6
\&{double} \|A${}\K(\\{xdist}+\|x.\|e)*(\\{ydist}+\|y.\|e);{}$\6
\&{double} \|B${}\K\\{ax}*\|y.\|e+\\{ay}*\|x.\|e;{}$\6
\&{double} \|C${}\K(\\{r\_f}.\|e+\\{r\_f0}.\|e)+(\\{r\_f1}.\|e+\\{r\_f2}.%
\|e);{}$\6
\&{double} \\{r\_error}${}\K(\T{1}+\T{3}*\.{EPS})*(\|A+(\|B+\|C));{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\\{r\_f0}.\|z,\39\\{r\_f1}.\|z,\39\\{r%
\_f2}.\|z,\39\\{r\_error}){}$;\par
\U68.\fi

\M{34}\proposition{J*d}
If \PB{\|x} is \PB{\&{ACJ}} and \PB{\|y} is \PB{\&{double}}, then
$\reps{x*y} \supset \reps{x} \reps{y}$.
\endproposition
\Y\B\4\X34:Definition of \PB{$\|x*\|y$} for \PB{\&{ACJ} \|x} and \PB{\&{double}
\|y}\X${}\E{}$\6
\&{AComplex} \\{r\_f}${}\K\|x.\|f*\|y;{}$\6
\&{AComplex} \\{r\_f0}${}\K\|x.\\{f0}*\|y;{}$\6
\&{AComplex} \\{r\_f1}${}\K\|x.\\{f1}*\|y;{}$\6
\&{AComplex} \\{r\_f2}${}\K\|x.\\{f2}*\|y;{}$\6
\&{double} \\{r\_error}${}\K(\T{1}+\T{3}*\.{EPS})*((\|x.\|e*\\{fabs}(\|y))+((%
\\{r\_f}.\|e+\\{r\_f0}.\|e)+(\\{r\_f1}.\|e+\\{r\_f2}.\|e)));{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\\{r\_f0}.\|z,\39\\{r\_f1}.\|z,\39\\{r%
\_f2}.\|z,\39\\{r\_error}){}$;\par
\U67.\fi

\M{35}\proposition{J/J}
If \PB{\|x} and \PB{\|y} are \PB{\&{ACJ}}, then
$\reps{x/y} \supset \reps{x} / \reps{y}$.
\endproposition
\Y\B\4\X35:Definition of \PB{$\|x/\|y$} for \PB{\&{ACJ} \|x${},{}$ \|y}\X${}%
\E{}$\6
\&{double} \\{xdist}${}\K\\{size}(\|x);{}$\6
\&{double} \\{ydist}${}\K\\{size}(\|y);{}$\6
\&{double} \\{ax}${}\K\\{absUB}(\|x.\|f),{}$ \\{ay}${}\K\\{absLB}(\|y.\|f);{}$\6
\&{double} \|D${}\K\\{ay}-(\T{1}+\.{EPS})*(\|y.\|e+\\{ydist});{}$\7
\&{if} ${}(\R(\|D>\T{0})){}$\1\5
\&{return} ${}\&{ACJ}(\T{0},\39\T{0},\39\T{0},\39\T{0},\39\\{infinity}(\,));{}$%
\2\7
\&{AComplex} \\{den}${}\K(\|y.\|f*\|y.\|f);{}$\6
\&{AComplex} \\{r\_f}${}\K\|x.\|f/\|y.\|f;{}$\6
\&{AComplex} \\{r\_f0}${}\K(\|x.\\{f0}*\|y.\|f-\|x.\|f*\|y.\\{f0})/\\{den};{}$\6
\&{AComplex} \\{r\_f1}${}\K(\|x.\\{f1}*\|y.\|f-\|x.\|f*\|y.\\{f1})/\\{den};{}$\6
\&{AComplex} \\{r\_f2}${}\K(\|x.\\{f2}*\|y.\|f-\|x.\|f*\|y.\\{f2})/\\{den};{}$\6
\&{double} \|A${}\K(\\{ax}+(\\{xdist}+\|x.\|e))/\|D;{}$\6
\&{double} \|B${}\K(\\{ax}/\\{ay}+\\{xdist}/\\{ay})+(\\{ydist}*\\{ax})/(\\{ay}*%
\\{ay});{}$\6
\&{double} \|C${}\K(\\{r\_f}.\|e+\\{r\_f0}.\|e)+(\\{r\_f1}.\|e+\\{r\_f2}.%
\|e);{}$\6
\&{double} \\{r\_error}${}\K(\T{1}+\T{3}*\.{EPS})*(((\T{1}+\T{3}*\.{EPS})*\|A-(%
\T{1}-\T{3}*\.{EPS})*\|B)+\|C);{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\\{r\_f0}.\|z,\39\\{r\_f1}.\|z,\39\\{r%
\_f2}.\|z,\39\\{r\_error}){}$;\par
\U68.\fi

\M{36}\proposition{d/J}
If \PB{\|x} is \PB{\&{double}} and \PB{\|y} is \PB{\&{ACJ}}, then
$\reps{x/y} \supset \reps{x} / \reps{y}$.
\endproposition
\Y\B\4\X36:Definition of \PB{$\|x/\|y$} for \PB{\&{double} \|x} and \PB{\&{ACJ}
\|y}\X${}\E{}$\6
\&{double} \\{ydist}${}\K\\{size}(\|y);{}$\6
\&{double} \\{ax}${}\K\\{fabs}(\|x),{}$ \\{ay}${}\K\\{absLB}(\|y.\|f);{}$\6
\&{double} \|D${}\K\\{ay}-(\T{1}+\.{EPS})*(\|y.\|e+\\{ydist});{}$\7
\&{if} ${}(\R(\|D>\T{0})){}$\1\5
\&{return} ${}\&{ACJ}(\T{0},\39\T{0},\39\T{0},\39\T{0},\39\\{infinity}(\,));{}$%
\2\7
\&{AComplex} \\{den}${}\K(\|y.\|f*\|y.\|f);{}$\6
\&{AComplex} \\{r\_f}${}\K\|x/\|y.\|f;{}$\6
\&{AComplex} \\{r\_f0}${}\K({-}\|x*\|y.\\{f0})/\\{den};{}$\6
\&{AComplex} \\{r\_f1}${}\K({-}\|x*\|y.\\{f1})/\\{den};{}$\6
\&{AComplex} \\{r\_f2}${}\K({-}\|x*\|y.\\{f2})/\\{den};{}$\6
\&{double} \|B${}\K\\{ax}/\\{ay}+(\\{ydist}*\\{ax})/(\\{ay}*\\{ay});{}$\6
\&{double} \|C${}\K(\\{r\_f}.\|e+\\{r\_f0}.\|e)+(\\{r\_f1}.\|e+\\{r\_f2}.%
\|e);{}$\6
\&{double} \\{r\_error}${}\K(\T{1}+\T{3}*\.{EPS})*(((\T{1}+\T{2}*\.{EPS})*(%
\\{ax}/\|D)-(\T{1}-\T{3}*\.{EPS})*\|B)+\|C);{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\\{r\_f0}.\|z,\39\\{r\_f1}.\|z,\39\\{r%
\_f2}.\|z,\39\\{r\_error}){}$;\par
\U68.\fi

\M{37}\proposition{J/d}
If \PB{\|x} is \PB{\&{ACJ}} and \PB{\|y} is \PB{\&{double}}, then
$\reps{\PB{$\|x/\|y$}} \supset \reps{x} / \reps{y}$.
\endproposition
\Y\B\4\X37:Definition of \PB{$\|x/\|y$} for \PB{\&{ACJ} \|x} and \PB{\&{double}
\|y}\X${}\E{}$\6
\&{AComplex} \\{r\_f}${}\K\|x.\|f/\|y;{}$\6
\&{AComplex} \\{r\_f0}${}\K\|x.\\{f0}/\|y;{}$\6
\&{AComplex} \\{r\_f1}${}\K\|x.\\{f1}/\|y;{}$\6
\&{AComplex} \\{r\_f2}${}\K\|x.\\{f2}/\|y;{}$\6
\&{double} \\{r\_error}${}\K(\T{1}+\T{3}*\.{EPS})*((\|x.\|e/\\{fabs}(\|y))+((%
\\{r\_f}.\|e+\\{r\_f0}.\|e)+(\\{r\_f1}.\|e+\\{r\_f2}.\|e)));{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\\{r\_f0}.\|z,\39\\{r\_f1}.\|z,\39\\{r%
\_f2}.\|z,\39\\{r\_error}){}$;\par
\U67.\fi

\M{38}\proposition{\PB{\\{sqrt}(\|J)}}
If \PB{\|x} is \PB{\&{ACJ}}, then
$\reps{\PB{\\{sqrt}(\|x)}} \supset \sqrt{\reps{x}}$.
\endproposition
\Y\B\4\X38:Definition of \PB{\\{sqrt}(\|x)} for \PB{\&{ACJ} \|x}\X${}\E{}$\6
\&{double} \\{xdist}${}\K\\{size}(\|x);{}$\6
\&{double} \\{ax}${}\K\\{absUB}(\|x.\|f);{}$\6
\&{double} \|D${}\K\\{ax}-(\T{1}+\.{EPS})*(\\{xdist}+\|x.\|e);{}$\7
\&{if} ${}(\R(\|D>\T{0})){}$\5
${}\{{}$\1\6
\&{return} ${}\&{ACJ}(\T{0},\39\T{0},\39\T{0},\39\T{0},\39(\T{1}+\T{2}*%
\.{EPS})*\\{sqrt}(\\{ax}+(\\{xdist}+\|x.\|e)));{}$\6
\4${}\}{}$\2\6
\&{else}\5
${}\{{}$\1\6
\&{AComplex} \\{r\_f}${}\K\\{sqrt}(\|x.\|f);{}$\6
\&{AComplex} \|t${}\K\\{r\_f}+\\{r\_f};{}$\6
\&{AComplex} \\{r\_f0}${}\K\&{AComplex}(\|x.\\{f0}.\\{re},\39\|x.\\{f0}.\\{im},%
\39\T{0})/\|t;{}$\6
\&{AComplex} \\{r\_f1}${}\K\&{AComplex}(\|x.\\{f1}.\\{re},\39\|x.\\{f1}.\\{im},%
\39\T{0})/\|t;{}$\6
\&{AComplex} \\{r\_f2}${}\K\&{AComplex}(\|x.\\{f2}.\\{re},\39\|x.\\{f2}.\\{im},%
\39\T{0})/\|t;{}$\6
\&{double} \\{r\_error}${}\K(\T{1}+\T{3}*\.{EPS})*(((\T{1}+\.{EPS})*\\{sqrt}(%
\\{ax})-(\T{1}-\T{3}*\.{EPS})*(\\{xdist}/(\T{2}*\\{sqrt}(\\{ax}))+\\{sqrt}(%
\|D)))+((\\{r\_f}.\|e+\\{r\_f0}.\|e)+(\\{r\_f1}.\|e+\\{r\_f2}.\|e)));{}$\7
\&{return} ${}\&{ACJ}(\\{r\_f}.\|z,\39\\{r\_f0}.\|z,\39\\{r\_f1}.\|z,\39\\{r%
\_f2}.\|z,\39\\{r\_error});{}$\6
\4${}\}{}$\2\par
\U68.\fi

\M{39}\proposition{\PB{\\{absUB}(\|J)}}
If \PB{\|x} is \PB{\&{ACJ}}, then
$\reps{\PB{\\{absUB}(\|x)}} >= \reps{x}(z)$ for all $z \in \cube$.
\endproposition
\Y\B\4\X39:Definition of \PB{\\{absUB}(\|x)} for \PB{\&{ACJ} \|x}\X${}\E{}$\6
\&{return} ${}(\T{1}+\T{2}*\.{EPS})*(\\{absUB}(\|x.\|f)+(\\{size}(\|x)+\|x.%
\|e)){}$;\par
\U67.\fi

\M{40}\proposition{\PB{\\{absLB}(\|J)}}
If \PB{\|x} is \PB{\&{ACJ}}, then
$\reps{\PB{\\{absLB}(\|x)}} <= \reps{x}(z)$ for all $z \in \cube$.
\endproposition
\Y\B\4\X40:Definition of \PB{\\{absLB}(\|x)} for \PB{\&{ACJ} \|x}\X${}\E{}$\6
\&{double} \|v${}\K(\T{1}-\.{EPS})*(\\{absLB}(\|x.\|f)-(\T{1}+\.{EPS})*(%
\\{size}(\|x)+\|x.\|e));{}$\7
\&{return} ${}(\|v>\T{0})\?\|v:\T{0}{}$;\par
\U67.\fi

\M{41}\proposition{\PB{\\{size}(\|J)}}
If \PB{$(\|j.\|f,\|j.\\{f0},\|j.\\{f1},\|j.\\{f2},$ \|j $.$ \&{error} )} is %
\PB{\&{ACJ}}, then
$\reps{\PB{\\{size}(\|j)}} \ge \abs{\reps{\PB{$\|j.\\{f0}$}}} + \abs{\reps{%
\PB{$\|j.\\{f1}$}}} + \abs{\reps{\PB{$\|j.\\{f2}$}}}$.
\endproposition
\Y\B\4\X41:Definition of \PB{\\{size}(\|x)} for \PB{\&{ACJ} \|x}\X${}\E{}$\6
\&{return} ${}\|x.\\{size}{}$;\par
\U67.\fi

\N{1}{42}Complex numbers.
This section implements complex numbers.
We need two kinds: \PB{\&{XComplex}},
for complex numbers which are represented exactly,
and \PB{\&{AComplex}}, which is an interval that contains the number we wish
to represent.
Most of the operations here act on \PB{\&{XComplex}} and produce \PB{%
\&{AComplex}}.

\fi

\M{43}An \PB{\&{XComplex}} $x$
represents the complex number $\reps{\PB{\|x}} = \reps{\PB{$\|x.\\{re}$}} + i %
\reps{\PB{$\|x.\\{im}$}}$.
\Y\B\4\X43:Definition of \PB{\&{XComplex}}\X${}\E{}$\6
\&{struct} \&{XComplex} ${}\{{}$\1\6
\&{double} \\{re};\6
\&{double} \\{im};\7
\4\&{XComplex}(\&{double} \|r${}\K\T{0},\39{}$\&{double} \|i${}\K\T{0}):{}$\5
${}\\{re}(\|r),\39\\{im}(\|i){}$\1\1\2\2\6
${}\{\,\}{}$\2\6
${}\}{}$;\par
\U63.\fi

\M{44}An \PB{\&{AComplex}} $x$ represents the set of complex numbers
$\reps{\PB{\|x}} = \{y : \abs{y-x.z} \le x.e\}$.

\Y\B\4\X44:Definition of \PB{\&{AComplex}}\X${}\E{}$\6
\&{struct} \&{AComplex} ${}\{{}$\1\6
\&{XComplex} \|z;\6
\&{double} \|e;\7
\4\&{AComplex}(\&{double} \|r${},\39{}$\&{double} \|i${},\39{}$\&{double} %
\\{err}):\5
${}\|z(\|r,\39\|i),\39\|e(\\{err}){}$\1\1\2\2\6
${}\{\,\}{}$\2\6
${}\}{}$;\par
\U63.\fi

\M{45}\proposition{-X}
If \PB{\|x} is \PB{\&{XComplex}}, then
$\reps{\PB{${-}\|x$}} = -\reps{\PB{\|x}}$.
\endproposition
\Y\B\4\X45:Definition of \PB{${-}\|x$} for \PB{\&{XComplex} \|x}\X${}\E{}$\6
\&{return} ${}\&{XComplex}({-}\|x.\\{re},\39{-}\|x.\\{im}){}$;\par
\U64.\fi

\M{46}\proposition{X+d}
If \PB{\|x} is \PB{\&{XComplex}} and \PB{\|y} is \PB{\&{double}}, then
$\reps{\PB{$\|x+\|y$}} \supset \reps{\PB{\|x}} + \reps{\PB{\|y}}$.
\Y\B\4\X46:Definition of \PB{$\|x+\|y$} for \PB{\&{XComplex} \|x} and \PB{%
\&{double} \|y}\X${}\E{}$\6
\&{double} \\{re}${}\K\|x.\\{re}+\|y;{}$\6
\&{double} \|e${}\K\.{HALFEPS}*\\{fabs}(\\{re});{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\|x.\\{im},\39\|e){}$;\par
\U64.\fi

\M{47}\proposition{X-d}
If \PB{\|x} is \PB{\&{XComplex}} and \PB{\|y} is \PB{\&{double}}, then
$\reps{\PB{$\|x-\|y$}} \supset \reps{\PB{\|x}} - \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X47:Definition of \PB{$\|x-\|y$} for \PB{\&{XComplex} \|x} and \PB{%
\&{double} \|y}\X${}\E{}$\6
\&{double} \\{re}${}\K\|x.\\{re}-\|y;{}$\6
\&{double} \|e${}\K\.{HALFEPS}*\\{fabs}(\\{re});{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\|x.\\{im},\39\|e){}$;\par
\U64.\fi

\M{48}\proposition{X+X}
If \PB{\|x} and \PB{\|y} are \PB{\&{XComplex}}, then
$\reps{\PB{$\|x+\|y$}} \supset \reps{\PB{\|x}} + \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X48:Definition of \PB{$\|x+\|y$} for \PB{\&{XComplex} \|x${},{}$ \|y}%
\X${}\E{}$\6
\&{double} \\{re}${}\K\|x.\\{re}+\|y.\\{re};{}$\6
\&{double} \\{im}${}\K\|x.\\{im}+\|y.\\{im};{}$\6
\&{double} \|e${}\K\.{HALFEPS}*((\T{1}+\.{EPS})*(\\{fabs}(\\{re})+\\{fabs}(%
\\{im})));{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\\{im},\39\|e){}$;\par
\U64.\fi

\M{49}\proposition{X-X}
If \PB{\|x} and \PB{\|y} are \PB{\&{XComplex}}, then
$\reps{\PB{$\|x-\|y$}} \supset \reps{\PB{\|x}} - \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X49:Definition of \PB{$\|x-\|y$} for \PB{\&{XComplex} \|x${},{}$ \|y}%
\X${}\E{}$\6
\&{double} \\{re}${}\K\|x.\\{re}-\|y.\\{re};{}$\6
\&{double} \\{im}${}\K\|x.\\{im}-\|y.\\{im};{}$\6
\&{double} \|e${}\K\.{HALFEPS}*((\T{1}+\.{EPS})*(\\{fabs}(\\{re})+\\{fabs}(%
\\{im})));{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\\{im},\39\|e){}$;\par
\U64.\fi

\M{50}\proposition{A+A}
If \PB{\|x} and \PB{\|y} are \PB{\&{AComplex}}, then
$\reps{\PB{$\|x+\|y$}} \supset \reps{\PB{\|x}} + \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X50:Definition of \PB{$\|x+\|y$} for \PB{\&{AComplex} \|x${},{}$ \|y}%
\X${}\E{}$\6
\&{double} \\{re}${}\K\|x.\|z.\\{re}+\|y.\|z.\\{re};{}$\6
\&{double} \\{im}${}\K\|x.\|z.\\{im}+\|y.\|z.\\{im};{}$\6
\&{double} \|e${}\K(\T{1}+\T{2}*\.{EPS})*(\.{HALFEPS}*(\\{fabs}(\\{re})+%
\\{fabs}(\\{im}))+(\|x.\|e+\|y.\|e));{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\\{im},\39\|e){}$;\par
\U64.\fi

\M{51}\proposition{A-A}
If \PB{\|x} and \PB{\|y} are \PB{\&{AComplex}}, then
$\reps{\PB{$\|x-\|y$}} \supset \reps{\PB{\|x}} - \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X51:Definition of \PB{$\|x-\|y$} for \PB{\&{AComplex} \|x${},{}$ \|y}%
\X${}\E{}$\6
\&{double} \\{re}${}\K\|x.\|z.\\{re}-\|y.\|z.\\{re};{}$\6
\&{double} \\{im}${}\K\|x.\|z.\\{im}-\|y.\|z.\\{im};{}$\6
\&{double} \|e${}\K(\T{1}+\T{2}*\.{EPS})*(\.{HALFEPS}*(\\{fabs}(\\{re})+%
\\{fabs}(\\{im}))+(\|x.\|e+\|y.\|e));{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\\{im},\39\|e){}$;\par
\U64.\fi

\M{52}\proposition{X*d}
If \PB{\|x} is \PB{\&{XComplex}} and \PB{\|y} is \PB{\&{double}}, then
$\reps{\PB{$\|x*\|y$}} \supset \reps{\PB{\|x}} \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X52:Definition of \PB{$\|x*\|y$} for \PB{\&{XComplex} \|x} and \PB{%
\&{double} \|y}\X${}\E{}$\6
\&{double} \\{re}${}\K\|x.\\{re}*\|y;{}$\6
\&{double} \\{im}${}\K\|x.\\{im}*\|y;{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\\{im},\39\.{HALFEPS}*((\T{1}+\.{EPS})*(%
\\{fabs}(\\{re})+\\{fabs}(\\{im})))){}$;\par
\U64.\fi

\M{53}\proposition{X/d}
If \PB{\|x} is \PB{\&{XComplex}} and \PB{\|y} is \PB{\&{double}}, then
$\reps{\PB{$\|x/\|y$}} \supset \reps{\PB{\|x}} / \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X53:Definition of \PB{$\|x/\|y$} for \PB{\&{XComplex} \|x} and \PB{%
\&{double} \|y}\X${}\E{}$\6
\&{double} \\{re}${}\K\|x.\\{re}/\|y;{}$\6
\&{double} \\{im}${}\K\|x.\\{im}/\|y;{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\\{im},\39\.{HALFEPS}*((\T{1}+\.{EPS})*(%
\\{fabs}(\\{re})+\\{fabs}(\\{im})))){}$;\par
\U64.\fi

\M{54}\proposition{X*X}
If \PB{\|x} and \PB{\|y} are \PB{\&{XComplex}}, then
$\reps{\PB{$\|x*\|y$}} \supset \reps{\PB{\|x}} \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X54:Definition of \PB{$\|x*\|y$} for \PB{\&{XComplex} \|x${},{}$ \|y}%
\X${}\E{}$\6
\&{double} \\{re1}${}\K\|x.\\{re}*\|y.\\{re},{}$ \\{re2}${}\K\|x.\\{im}*\|y.%
\\{im};{}$\6
\&{double} \\{im1}${}\K\|x.\\{re}*\|y.\\{im},{}$ \\{im2}${}\K\|x.\\{im}*\|y.%
\\{re};{}$\6
\&{double} \|e${}\K\.{EPS}*((\T{1}+\T{2}*\.{EPS})*((\\{fabs}(\\{re1})+\\{fabs}(%
\\{re2}))+(\\{fabs}(\\{im1})+\\{fabs}(\\{im2}))));{}$\7
\&{return} ${}\&{AComplex}(\\{re1}-\\{re2},\39\\{im1}+\\{im2},\39\|e){}$;\par
\U64.\fi

\M{55}\proposition{d/X}
If \PB{\|x} is \PB{\&{double}} and \PB{\|y} is \PB{\&{XComplex}}, then
$\reps{\PB{$\|x/\|y$}} \supset \reps{\PB{\|x}} / \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X55:Definition of \PB{$\|x/\|y$} for \PB{\&{double} \|x} and \PB{%
\&{XComplex} \|y}\X${}\E{}$\6
\&{double} \\{nrm}${}\K\|y.\\{re}*\|y.\\{re}+\|y.\\{im}*\|y.\\{im};{}$\6
\&{double} \\{re}${}\K(\|x*\|y.\\{re})/\\{nrm};{}$\6
\&{double} \\{im}${}\K{-}(\|x*\|y.\\{im})/\\{nrm};{}$\6
\&{double} \|e${}\K(\T{2}*\.{EPS})*((\T{1}+\T{2}*\.{EPS})*(\\{fabs}(\\{re})+%
\\{fabs}(\\{im})));{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\\{im},\39\|e){}$;\par
\U65.\fi

\M{56}\proposition{X/X}
If \PB{\|x} and \PB{\|y} are \PB{\&{XComplex}}, then
$\reps{\PB{$\|x/\|y$}} \supset \reps{\PB{\|x}} / \reps{\PB{\|y}}$.
\endproposition
\Y\B\4\X56:Definition of \PB{$\|x/\|y$} for \PB{\&{XComplex} \|x${},{}$ \|y}%
\X${}\E{}$\6
\&{double} \\{nrm}${}\K\|y.\\{re}*\|y.\\{re}+\|y.\\{im}*\|y.\\{im};{}$\6
\&{double} \\{xryr}${}\K\|x.\\{re}*\|y.\\{re};{}$\6
\&{double} \\{xiyi}${}\K\|x.\\{im}*\|y.\\{im};{}$\6
\&{double} \\{xiyr}${}\K\|x.\\{im}*\|y.\\{re};{}$\6
\&{double} \\{xryi}${}\K\|x.\\{re}*\|y.\\{im};{}$\6
\&{double} \\{re}${}\K(\\{xryr}+\\{xiyi})/\\{nrm};{}$\6
\&{double} \\{im}${}\K(\\{xiyr}-\\{xryi})/\\{nrm};{}$\6
\&{double} \|A${}\K((\\{fabs}(\\{xryr})+\\{fabs}(\\{xiyi}))+(\\{fabs}(%
\\{xiyr})+\\{fabs}(\\{xryi})))/\\{nrm};{}$\6
\&{double} \|e${}\K(\T{5}*\.{HALFEPS})*((\T{1}+\T{3}*\.{EPS})*\|A);{}$\7
\&{return} ${}\&{AComplex}(\\{re},\39\\{im},\39\|e){}$;\par
\U65.\fi

\M{57}\proposition{A/A}
If \PB{\|x} and \PB{\|y} are \PB{\&{AComplex}}, then
$\reps{\PB{$\|x/\|y$}} \supset \reps{\PB{\|x}} / \reps{\PB{\|y}}$.
\Y\B\4\X57:Definition of \PB{$\|x/\|y$} for \PB{\&{AComplex} \|x${},{}$ \|y}%
\X${}\E{}$\6
\&{double} \\{nrm}${}\K\|y.\|z.\\{re}*\|y.\|z.\\{re}+\|y.\|z.\\{im}*\|y.\|z.%
\\{im};{}$\6
\&{double} \\{xryr}${}\K\|x.\|z.\\{re}*\|y.\|z.\\{re};{}$\6
\&{double} \\{xiyi}${}\K\|x.\|z.\\{im}*\|y.\|z.\\{im};{}$\6
\&{double} \\{xiyr}${}\K\|x.\|z.\\{im}*\|y.\|z.\\{re};{}$\6
\&{double} \\{xryi}${}\K\|x.\|z.\\{re}*\|y.\|z.\\{im};{}$\7
${}\\{assert}(\|y.\|e*\|y.\|e<(\T{10000}*\.{EPS}*\.{EPS})*\\{nrm});{}$\7
\&{double} \|A${}\K(\\{fabs}(\\{xryr})+\\{fabs}(\\{xiyi}))+(\\{fabs}(\\{xiyr})+%
\\{fabs}(\\{xryi}));{}$\6
\&{double} \|B${}\K\|x.\|e*(\\{fabs}(\|y.\|z.\\{re})+\\{fabs}(\|y.\|z.\\{im}))+%
\|y.\|e*(\\{fabs}(\|x.\|z.\\{re})+\\{fabs}(\|x.\|z.\\{im}));{}$\6
\&{double} \|e${}\K(\T{1}+\T{4}*\.{EPS})*(((\T{5}*\.{HALFEPS})*\|A+(\T{1}+%
\T{103}*\.{EPS})*\|B)/\\{nrm});{}$\7
\&{return} ${}\&{AComplex}((\\{xryr}+\\{xiyi})/\\{nrm},\39(\\{xiyr}-\\{xryi})/%
\\{nrm},\39\|e){}$;\par
\U65.\fi

\M{58}If \PB{\|x} is \PB{\&{XComplex}}, then
$\reps{\PB{\\{sqrt}(\|x)}} \supset \sqrt{\reps{\PB{\|x}}}$.

\Y\B\4\X58:Definition of \PB{\\{sqrt}(\|x)} for \PB{\&{XComplex} \|x}\X${}\E{}$%
\6
\&{double} \|s${}\K\\{sqrt}((\\{fabs}(\|x.\\{re})+\\{hypot}(\|x.\\{re},\39\|x.%
\\{im}))*\T{0.5});{}$\6
\&{double} \|d${}\K(\|x.\\{im}/\|s)*\T{0.5};{}$\6
\&{double} \|e${}\K\.{EPS}*((\T{1}+\T{4}*\.{EPS})*(\T{1.25}*\|s+\T{1.75}*%
\\{fabs}(\|d)));{}$\7
\&{if} ${}(\|x.\\{re}>\T{0.0}){}$\1\5
\&{return} ${}\&{AComplex}(\|s,\39\|d,\39\|e);{}$\2\6
\&{else}\1\5
\&{return} ${}\&{AComplex}(\|d,\39\|s,\39\|e){}$;\2\par
\U65.\fi

\M{59}If \PB{\|x} is \PB{\&{XComplex}}, then
$\reps{\PB{\\{absUB}(\|x)}} \ge \abs{\reps{\PB{\|x}}}$.
\Y\B\4\X59:Definition of \PB{\\{absUB}(\|x)} for \PB{\&{XComplex} \|x}\X${}%
\E{}$\6
\&{return} ${}(\T{1}+\T{2}*\.{EPS})*\\{hypot}(\|x.\\{re},\39\|x.\\{im}){}$;\par
\U64.\fi

\M{60}If \PB{\|x} is \PB{\&{XComplex}}, then
$\reps{\PB{\\{absLB}(\|x)}} \le \abs{\reps{\PB{\|x}}}$.
\Y\B\4\X60:Definition of \PB{\\{absLB}(\|x)} for \PB{\&{XComplex} \|x}\X${}%
\E{}$\6
\&{return} ${}(\T{1}-\T{2}*\.{EPS})*\\{hypot}(\|x.\\{re},\39\|x.\\{im}){}$;\par
\U64.\fi

\N{1}{61}Technical details.
This section contains the \CEE/++ ``glue'' which tells
the computer how to use the definitions of the operators
on \PB{\&{XComplex}}, \PB{\&{AComplex}}, \PB{\&{ACJ}} and \PB{\&{SL2ACJ}}.

\Y\B\4\X61:\.{roundoff.h }\X${}\E{}$\6
\8\#\&{ifndef} \\{\_roundoff\_h\_}\6
\8\#\&{define} \\{\_roundoff\_h\_}\6
\8\#\&{include} \.{<float.h>}\6
\8\#\&{include} \.{<math.h>}\6
\X8:Definition of \PB{\.{EPS}} and \PB{\.{HALFEPS}}\X\6
\X9:Declaration of floating-point functions\X\6
\8\#\&{endif}\par
\fi

\M{62}\B\X62:\.{roundoff.c }\X${}\E{}$\6
\8\#\&{include} \.{"roundoff.h"}\6
\X10:Definition of floating-point functions\X\par
\fi

\M{63}\B\X63:\.{Complex.h }\X${}\E{}$\6
\8\#\&{ifndef} \\{\_Complex\_h\_}\6
\8\#\&{define} \\{\_Complex\_h\_}\6
\8\#\&{include} \.{<assert.h>}\6
\8\#\&{include} \.{"roundoff.h"}\6
\X43:Definition of \PB{\&{XComplex}}\X\6
\X44:Definition of \PB{\&{AComplex}}\X\7
\&{inline} \&{const} \&{XComplex} ${}\&{operator}{-}{}$(\&{const} \&{XComplex}
${}{\AND}\|x);{}$\6
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{+}{}$(\&{const} \&{AComplex}
${}{\AND}\|x,\39{}$\&{const} \&{AComplex} ${}{\AND}\|y);{}$\6
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{+}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{const} \&{XComplex} ${}{\AND}\|y);{}$\6
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{+}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{double} \|y);\6
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{-}{}$(\&{const} \&{AComplex}
${}{\AND}\|x,\39{}$\&{const} \&{AComplex} ${}{\AND}\|y);{}$\6
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{-}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{const} \&{XComplex} ${}{\AND}\|y);{}$\6
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{-}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{double} \|y);\6
\&{inline} \&{const} \&{AComplex} ${}\&{operator}*{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{const} \&{XComplex} ${}{\AND}\|y);{}$\6
\&{inline} \&{const} \&{AComplex} ${}\&{operator}*{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{double} \|y);\6
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{/}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{double} \|y);\6
\&{inline} \&{const} \&{double} \\{absLB}(\&{const} \&{XComplex} ${}{\AND}%
\|x);{}$\6
\&{inline} \&{const} \&{double} \\{absUB}(\&{const} \&{XComplex} ${}{\AND}%
\|x);{}$\6
\&{AComplex} ${}\&{operator}{/}{}$(\&{const} \&{AComplex} ${}{\AND}\|x,\39{}$%
\&{const} \&{AComplex} ${}{\AND}\|y);{}$\6
\&{AComplex} ${}\&{operator}{/}{}$(\&{const} \&{XComplex} ${}{\AND}\|x,\39{}$%
\&{const} \&{XComplex} ${}{\AND}\|y);{}$\6
\&{AComplex} ${}\&{operator}{/}{}$(\&{double} \|x${},\39{}$\&{const} %
\&{XComplex} ${}{\AND}\|y);{}$\6
\&{AComplex} \\{sqrt}(\&{const} \&{XComplex} ${}{\AND}\|x);{}$\6
\8\#\&{include} \.{"Complex.inline"}\6
\8\#\&{endif}\par
\fi

\M{64}\B\X64:\.{Complex.inline }\X${}\E{}$\6
\&{inline} \&{const} \&{XComplex} ${}\&{operator}{-}{}$(\&{const} \&{XComplex}
${}{\AND}\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X45:Definition of \PB{${-}\|x$} for \PB{\&{XComplex} \|x}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{+}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{const} \&{XComplex} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X48:Definition of \PB{$\|x+\|y$} for \PB{\&{XComplex} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{+}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{double} \|y)\1\1\2\2\6
${}\{{}$\1\6
\X46:Definition of \PB{$\|x+\|y$} for \PB{\&{XComplex} \|x} and \PB{\&{double} %
\|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{+}{}$(\&{const} \&{AComplex}
${}{\AND}\|x,\39{}$\&{const} \&{AComplex} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X50:Definition of \PB{$\|x+\|y$} for \PB{\&{AComplex} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{-}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{const} \&{XComplex} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X49:Definition of \PB{$\|x-\|y$} for \PB{\&{XComplex} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{-}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{double} \|y)\1\1\2\2\6
${}\{{}$\1\6
\X47:Definition of \PB{$\|x-\|y$} for \PB{\&{XComplex} \|x} and \PB{\&{double} %
\|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{-}{}$(\&{const} \&{AComplex}
${}{\AND}\|x,\39{}$\&{const} \&{AComplex} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X51:Definition of \PB{$\|x-\|y$} for \PB{\&{AComplex} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{AComplex} ${}\&{operator}*{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{const} \&{XComplex} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X54:Definition of \PB{$\|x*\|y$} for \PB{\&{XComplex} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{AComplex} ${}\&{operator}*{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{double} \|y)\1\1\2\2\6
${}\{{}$\1\6
\X52:Definition of \PB{$\|x*\|y$} for \PB{\&{XComplex} \|x} and \PB{\&{double} %
\|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{AComplex} ${}\&{operator}{/}{}$(\&{const} \&{XComplex}
${}{\AND}\|x,\39{}$\&{double} \|y)\1\1\2\2\6
${}\{{}$\1\6
\X53:Definition of \PB{$\|x/\|y$} for \PB{\&{XComplex} \|x} and \PB{\&{double} %
\|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{double} \\{absLB}(\&{const} \&{XComplex} ${}{\AND}%
\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X60:Definition of \PB{\\{absLB}(\|x)} for \PB{\&{XComplex} \|x}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{double} \\{absUB}(\&{const} \&{XComplex} ${}{\AND}%
\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X59:Definition of \PB{\\{absUB}(\|x)} for \PB{\&{XComplex} \|x}\X\6
\4${}\}{}$\2\par
\fi

\M{65}\B\X65:\.{Complex.C }\X${}\E{}$\6
\8\#\&{include} \.{"Complex.h"}\6
\&{AComplex} ${}\&{operator}{/}{}$(\&{const} \&{AComplex} ${}{\AND}\|x,\39{}$%
\&{const} \&{AComplex} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X57:Definition of \PB{$\|x/\|y$} for \PB{\&{AComplex} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{AComplex} ${}\&{operator}{/}{}$(\&{const} \&{XComplex} ${}{\AND}\|x,\39{}$%
\&{const} \&{XComplex} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X56:Definition of \PB{$\|x/\|y$} for \PB{\&{XComplex} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{AComplex} ${}\&{operator}{/}{}$(\&{double} \|x${},\39{}$\&{const} %
\&{XComplex} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X55:Definition of \PB{$\|x/\|y$} for \PB{\&{double} \|x} and \PB{\&{XComplex} %
\|y}\X\6
\4${}\}{}$\2\7
\&{AComplex} \\{sqrt}(\&{const} \&{XComplex} ${}{\AND}\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X58:Definition of \PB{\\{sqrt}(\|x)} for \PB{\&{XComplex} \|x}\X\6
\4${}\}{}$\2\par
\fi

\M{66}\B\X66:\.{ACJ.h }\X${}\E{}$\6
\8\#\&{ifndef} \\{\_ACJ\_h\_}\6
\8\#\&{define} \\{\_ACJ\_h\_}\6
\8\#\&{include} \.{"Complex.h"}\6
\8\#\&{include} \.{<assert.h>}\6
\8\#\&{include} \.{<stdio.h>}\6
\8\#\&{include} \.{"roundoff.h"}\6
\X27:Definition of \PB{\&{ACJ}}\X\7
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{-}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x);{}$\6
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{+}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{const} \&{ACJ} ${}{\AND}\|y);{}$\6
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{-}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{const} \&{ACJ} ${}{\AND}\|y);{}$\6
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{+}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{double} \|y);\6
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{-}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{const} \&{ACJ} ${}{\AND}\|y);{}$\6
\&{inline} \&{const} \&{ACJ} ${}\&{operator}*{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{double} \|y);\6
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{/}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{double} \|y);\6
\&{inline} \&{const} \&{double} \\{absUB}(\&{const} \&{ACJ} ${}{\AND}\|x);{}$\6
\&{inline} \&{const} \&{double} \\{absLB}(\&{const} \&{ACJ} ${}{\AND}\|x);{}$\6
\&{inline} \&{const} \&{double} \\{size}(\&{const} \&{ACJ} ${}{\AND}\|x);{}$\6
\&{const} \&{ACJ} ${}\&{operator}*{}$(\&{const} \&{ACJ} ${}{\AND}\|x,\39{}$%
\&{const} \&{ACJ} ${}{\AND}\|y);{}$\6
\&{const} \&{ACJ} ${}\&{operator}{/}{}$(\&{const} \&{ACJ} ${}{\AND}\|x,\39{}$%
\&{const} \&{ACJ} ${}{\AND}\|y);{}$\6
\&{const} \&{ACJ} ${}\&{operator}{/}{}$(\&{double} \|x${},\39{}$\&{const} %
\&{ACJ} ${}{\AND}\|y);{}$\6
\&{const} \&{ACJ} \\{sqrt}(\&{const} \&{ACJ} ${}{\AND}\|x);{}$\6
\8\#\&{include} \.{"ACJ.inline"}\6
\8\#\&{endif}\par
\fi

\M{67}\B\X67:\.{ACJ.inline }\X${}\E{}$\6
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{-}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X28:Definition of \PB{${-}\|x$} for \PB{\&{ACJ} \|x}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{+}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{const} \&{ACJ} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X29:Definition of \PB{$\|x+\|y$} for \PB{\&{ACJ} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{-}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{const} \&{ACJ} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X30:Definition of \PB{$\|x-\|y$} for \PB{\&{ACJ} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{+}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{double} \|y)\1\1\2\2\6
${}\{{}$\1\6
\X31:Definition of \PB{$\|x+\|y$} for \PB{\&{ACJ} \|x} and \PB{\&{double} \|y}%
\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{-}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{double} \|y)\1\1\2\2\6
${}\{{}$\1\6
\X32:Definition of \PB{$\|x-\|y$} for \PB{\&{ACJ} \|x} and \PB{\&{double} \|y}%
\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{ACJ} ${}\&{operator}*{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{double} \|y)\1\1\2\2\6
${}\{{}$\1\6
\X34:Definition of \PB{$\|x*\|y$} for \PB{\&{ACJ} \|x} and \PB{\&{double} \|y}%
\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{ACJ} ${}\&{operator}{/}{}$(\&{const} \&{ACJ} ${}{\AND}%
\|x,\39{}$\&{double} \|y)\1\1\2\2\6
${}\{{}$\1\6
\X37:Definition of \PB{$\|x/\|y$} for \PB{\&{ACJ} \|x} and \PB{\&{double} \|y}%
\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{double} \\{absUB}(\&{const} \&{ACJ} ${}{\AND}\|x){}$\1%
\1\2\2\6
${}\{{}$\1\6
\X39:Definition of \PB{\\{absUB}(\|x)} for \PB{\&{ACJ} \|x}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{double} \\{absLB}(\&{const} \&{ACJ} ${}{\AND}\|x){}$\1%
\1\2\2\6
${}\{{}$\1\6
\X40:Definition of \PB{\\{absLB}(\|x)} for \PB{\&{ACJ} \|x}\X\6
\4${}\}{}$\2\7
\&{inline} \&{const} \&{double} \\{size}(\&{const} \&{ACJ} ${}{\AND}\|x){}$\1\1%
\2\2\6
${}\{{}$\1\6
\X41:Definition of \PB{\\{size}(\|x)} for \PB{\&{ACJ} \|x}\X\6
\4${}\}{}$\2\par
\fi

\M{68}\B\X68:\.{ACJ.C }\X${}\E{}$\6
\8\#\&{include} \.{"ACJ.h"}\6
\&{const} \&{ACJ} ${}\&{operator}*{}$(\&{const} \&{ACJ} ${}{\AND}\|x,\39{}$%
\&{const} \&{ACJ} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X33:Definition of \PB{$\|x*\|y$} for \PB{\&{ACJ} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{const} \&{ACJ} ${}\&{operator}{/}{}$(\&{const} \&{ACJ} ${}{\AND}\|x,\39{}$%
\&{const} \&{ACJ} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X35:Definition of \PB{$\|x/\|y$} for \PB{\&{ACJ} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{const} \&{ACJ} ${}\&{operator}{/}{}$(\&{double} \|x${},\39{}$\&{const} %
\&{ACJ} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X36:Definition of \PB{$\|x/\|y$} for \PB{\&{double} \|x} and \PB{\&{ACJ} \|y}%
\X\6
\4${}\}{}$\2\7
\&{const} \&{ACJ} \\{sqrt}(\&{const} \&{ACJ} ${}{\AND}\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X38:Definition of \PB{\\{sqrt}(\|x)} for \PB{\&{ACJ} \|x}\X\6
\4${}\}{}$\2\par
\fi

\M{69}\B\X69:\.{SL2ACJ.h }\X${}\E{}$\6
\8\#\&{ifndef} \\{\_SL2ACJ\_h\_}\6
\8\#\&{define} \\{\_SL2ACJ\_h\_}\6
\8\#\&{include} \.{"ACJ.h"}\6
\X18:Definition of \PB{\&{SL2ACJ}}\X\7
\&{const} \&{SL2ACJ} ${}\&{operator}*{}$(\&{const} \&{SL2ACJ} ${}{\AND}\|x,%
\39{}$\&{const} \&{SL2ACJ} ${}{\AND}\|y);{}$\6
\&{const} \&{SL2ACJ} \\{inverse}(\&{const} \&{SL2ACJ} ${}{\AND}\|x);{}$\6
\&{const} \&{ACJ} \\{orthodist}(\&{const} \&{SL2ACJ} ${}{\AND}\|x);{}$\6
\&{const} \&{ACJ} \\{length}(\&{const} \&{SL2ACJ} ${}{\AND}\|x);{}$\6
\&{const} \&{int} \\{notIdentity}(\&{const} \&{SL2ACJ} ${}{\AND}\|x);{}$\6
\&{const} \&{int} \\{notFPower}(\&{const} \&{SL2ACJ} ${}{\AND}\|x);{}$\6
\&{const} \&{SL2ACJ} \\{shortGenerator}(\&{const} \&{ACJ} ${}{\AND}\|z);{}$\6
\&{const} \&{SL2ACJ} \\{closeGenerator}(\&{const} \&{ACJ} ${}{\AND}\|x,\39{}$%
\&{const} \&{ACJ} ${}{\AND}\|x);{}$\6
\8\#\&{endif}\par
\fi

\M{70}\B\X70:\.{SL2ACJ.C }\X${}\E{}$\6
\8\#\&{include} \.{"SL2ACJ.h"}\6
\&{const} \&{SL2ACJ} ${}\&{operator}*{}$(\&{const} \&{SL2ACJ} ${}{\AND}\|x,%
\39{}$\&{const} \&{SL2ACJ} ${}{\AND}\|y){}$\1\1\2\2\6
${}\{{}$\1\6
\X19:Definition of \PB{$\|x*\|y$} for \PB{\&{SL2ACJ} \|x${},{}$ \|y}\X\6
\4${}\}{}$\2\7
\&{const} \&{SL2ACJ} \\{inverse}(\&{const} \&{SL2ACJ} ${}{\AND}\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X20:Definition of \PB{\\{inverse}(\|x)} for \PB{\&{SL2ACJ} \|x}\X\6
\4${}\}{}$\2\7
\&{const} \&{ACJ} \\{orthodist}(\&{const} \&{SL2ACJ} ${}{\AND}\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X21:Definition of \PB{\\{orthodist}(\|x)} for \PB{\&{SL2ACJ} \|x}\X\6
\4${}\}{}$\2\7
\&{const} \&{ACJ} \\{length}(\&{const} \&{SL2ACJ} ${}{\AND}\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X22:Definition of \PB{\\{length}(\|x)} for \PB{\&{SL2ACJ} \|x}\X\6
\4${}\}{}$\2\7
\&{const} \&{int} \\{notIdentity}(\&{const} \&{SL2ACJ} ${}{\AND}\|x){}$\1\1\2\2%
\6
${}\{{}$\1\6
\X23:Definition of \PB{\\{notIdentity}(\|x)} for \PB{\&{SL2ACJ} \|x}\X\6
\4${}\}{}$\2\7
\&{const} \&{int} \\{notFPower}(\&{const} \&{SL2ACJ} ${}{\AND}\|x){}$\1\1\2\2\6
${}\{{}$\1\6
\X24:Definition of \PB{\\{notFPower}(\|x)} for \PB{\&{SL2ACJ} \|x}\X\6
\4${}\}{}$\2\7
\&{const} \&{SL2ACJ} \\{shortGenerator}(\&{const} \&{ACJ} ${}{\AND}\|z){}$\1\1%
\2\2\6
${}\{{}$\1\6
\X25:Definition of \PB{\\{shortGenerator}(\|z)} for \PB{\&{ACJ} \|z}\X\6
\4${}\}{}$\2\7
\&{const} \&{SL2ACJ} \\{closeGenerator}(\&{const} \&{ACJ} ${}{\AND}\|x,\39{}$%
\&{const} \&{ACJ} ${}{\AND}\|z){}$\1\1\2\2\6
${}\{{}$\1\6
\X26:Definition of \PB{$\\{closeGenerator}(\|x,\|z)$} for \PB{\&{ACJ} %
\|x${},{}$ \|z}\X\6
\4${}\}{}$\2\par
\fi

\M{71}\B\X71:\.{Codes.h }\X${}\E{}$\6
\8\#\&{ifndef} \\{\_Codes\_h\_}\6
\8\#\&{define} \\{Codes\_h\_}\6
\8\#\&{include} \.{"roundoff.h"}\6
\8\#\&{include} \.{"SL2ACJ.h"}\6
\&{int} \\{inequalityHolds}(\&{const} \&{char} ${}{*}\\{code},\39{}$\&{const} %
\&{char} ${}{*}\\{where},\39{}$\&{int} \\{depth});\6
\&{SL2ACJ} \\{evaluateWord}(\&{const} \&{char} ${}{*}\\{word},\39{}$\&{const} %
\&{ACJ} ${}{\AND}\\{along},\39{}$\&{const} \&{ACJ} ${}{\AND}\\{ortho},\39{}$%
\&{const} \&{ACJ} ${}{\AND}\\{whirle});{}$\6
\&{int} \\{wordImpliesCommuting}(\&{const} \&{char} ${}{*}\\{word});{}$\6
\&{int} \\{covers\_hole}(\&{const} \&{char} ${}{*}\\{where},\39{}$\&{int} %
\\{depth}${},\39{}$\&{double} ${}{*}\\{min\_d},\39{}$\&{ACJ} ${}{*}\\{max%
\_angle});{}$\6
\&{ACJ} \\{horizon}(\&{ACJ} ${}{\AND}\\{ortho});{}$\6
\&{int} \\{larger\_angle}(\&{ACJ} ${}{\AND}\|x,\39{}$\&{ACJ} ${}{\AND}\|y);{}$\6
\8\#\&{endif}\par
\fi

\M{72}\B\X72:\.{Codes.C }\X${}\E{}$\6
\8\#\&{include} \.{"Codes.h"}\6
\8\#\&{include} \.{"SL2ACJ.h"}\6
\8\#\&{include} \.{"roundoff.h"}\6
\8\#\&{include} \.{<stdio.h>}\6
\X11:Definition of \PB{\\{inequalityHolds}}\X\6
\X13:Definition of \PB{\\{evaluateWord}}\X\6
\X14:Definition of \PB{\\{wordImpliesCommuting}}\X\6
\X15:Definition of \PB{\\{covers\_hole}}\X\6
\X16:Definition of \PB{\\{horizon}}\X\6
\X17:Definition of \PB{\\{larger\_angle}}\X\par
\fi

\M{73}\B\X73:\.{verify.C }\X${}\E{}$\6
\8\#\&{include} \.{"Codes.h"}\6
\8\#\&{include} \.{<stdio.h>}\6
\8\#\&{include} \.{"roundoff.h"}\6
\X7:Definition of \PB{\.{MAXDEPTH}}\X\6
\X5:Definition of \PB{\\{inequalityFor}}\X\6
\X4:Definition of \PB{\\{verify}}\X\6
\X6:Definition of \PB{\\{main}}\X\par
\fi


\inx
\fin
\con
